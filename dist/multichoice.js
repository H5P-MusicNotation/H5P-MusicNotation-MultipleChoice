(()=>{var e=e||{};e.MultiChoiceScore4LMS=function(t,n,a){if(!(this instanceof e.MultiChoiceScore4LMS))return new e.MultiChoiceScore4LMS(t,n,a);var r=this;this.contentId=n,this.contentData=a,e.Question.call(r,"MultiChoiceScore4LMS");for(var s=e.jQuery,i=new EJS({text:'<ul class="h5p-answers" role="<%= role %>" aria-labelledby="<%= label %>">  <% for (var i=0; i < answers.length; i++) { %>    <li class="h5p-answer" role="<%= answers[i].role %>" tabindex="<%= answers[i].tabindex %>" aria-checked="<%= answers[i].checked %>" data-id="<%= i %>">      <div class="h5p-alternative-container">        <span class="h5p-alternative-inner"><%= answers[i].text %></span>      </div>      <div class="h5p-clearfix"></div>    </li>  <% } %></ul>'}),o=s.extend(!0,{image:null,question:"No question text provided",answers:[{tipsAndFeedback:{tip:"",chosenFeedback:"",notChosenFeedback:""},text:"Answer 1",correct:!0}],overallFeedback:[],weight:1,userAnswers:[],UI:{checkAnswerButton:"Check",submitAnswerButton:"Submit",showSolutionButton:"Show solution",tryAgainButton:"Try again",scoreBarLabel:"You got :num out of :total points",tipAvailable:"Tip available",feedbackAvailable:"Feedback available",readFeedback:"Read feedback",shouldCheck:"Should have been checked",shouldNotCheck:"Should not have been checked",noInput:"Input is required before viewing the solution",a11yCheck:"Check the answers. The responses will be marked as correct, incorrect, or unanswered.",a11yShowSolution:"Show the solution. The task will be marked with its correct solution.",a11yRetry:"Retry the task. Reset all responses and start the task over again."},behaviour:{enableRetry:!0,enableSolutionsButton:!0,enableCheckButton:!0,type:"auto",singlePoint:!0,randomAnswers:!1,showSolutionsRequiresInput:!0,autoCheck:!1,passPercentage:100,showScorePoints:!0}},t),c=0,h=0;h<o.answers.length;h++){var l=o.answers[h];l.tipsAndFeedback=l.tipsAndFeedback||{},o.answers[h].correct&&c++}var u=0===c;"auto"===o.behaviour.type?o.behaviour.singleAnswer=1===c:o.behaviour.singleAnswer="single"===o.behaviour.type;var d,p,w=function(){d.unbind("click",w),d.find(".h5p-feedback-button, .h5p-feedback-dialog").remove(),d.find(".h5p-has-feedback").removeClass("h5p-has-feedback"),p&&p.remove()},b=0,v=!1,f=function(e,t){p=s('<div class="h5p-feedback-dialog"><div class="h5p-feedback-inner"><div class="h5p-feedback-text" aria-hidden="true">'+t+"</div></div></div>"),e.find(s(".h5p-feedback-dialog")).length||p.appendTo(e.addClass("h5p-has-feedback"))};r.registerDomElements=function(){var e,t,n=o.media;if(n&&n.type&&n.type.library){var a=(n=n.type).library.split(" ")[0];"H5P.Image"===a?n.params.file&&r.setImage(n.params.file.path,{disableImageZooming:o.media.disableImageZooming||!1,alt:n.params.alt,title:n.params.title}):"H5P.Video"===a?n.params.sources&&r.setVideo(n):"H5P.Audio"===a&&n.params.files&&r.setAudio(n)}for(var c=0;c<o.answers.length;c++)o.answers[c].checkboxOrRadioIcon=(e=o.behaviour.singleAnswer,t=o.userAnswers.indexOf(c)>-1,e?t?"&#xe603;":"&#xe600;":t?"&#xe601;":"&#xe602;");r.setIntroduction('<div id="'+o.label+'">'+o.question+"</div>"),d=s(i.render(o)),r.setContent(d,{class:o.behaviour.singleAnswer?"h5p-radio":"h5p-check"});var h=s(".h5p-answer",d).each((function(e){var t=o.answers[e].tipsAndFeedback.tip;if(void 0!==t&&(t=t.trim()).replace(/&nbsp;/g,"").replace(/<p>/g,"").replace(/<\/p>/g,"").trim().length){s(this).addClass("h5p-has-tip");var n=s("<div/>",{class:"h5p-MultiChoiceScore4LMS-tipwrap","aria-label":o.UI.tipAvailable+"."}),a=s("<div>",{role:"button",tabindex:0,title:o.UI.tipsLabel,"aria-label":o.UI.tipsLabel,"aria-expanded":!1,class:"MultiChoiceScore4LMS-tip",appendTo:n});a.append('<span class="joubel-icon-tip-normal"><span class="h5p-icon-shadow"></span><span class="h5p-icon-speech-bubble"></span><span class="h5p-icon-info"></span></span>'),a.click((function(){var e=a.parents(".h5p-answer"),n=!e.children(".h5p-feedback-dialog").is(p);return w(),n?(a.attr("aria-expanded",!0),f(e,t),p.addClass("h5p-has-tip"),r.read(t)):a.attr("aria-expanded",!1),r.trigger("resize"),setTimeout((function(){d.click(w)}),100),!1})).keydown((function(e){if(32===e.which)return s(this).click(),!1})),s(".h5p-alternative-container",this).append(n)}})),l=function(e){if("true"!==e.attr("aria-disabled")){r.answered=!0;var t=parseInt(e.data("id"));if(o.behaviour.singleAnswer)o.userAnswers=[t],b=o.answers[t].correct?1:0,h.not(e).removeClass("h5p-selected").attr("tabindex","-1").attr("aria-checked","false"),e.addClass("h5p-selected").attr("tabindex","0").attr("aria-checked","true");else{if("true"===e.attr("aria-checked")){const n=o.userAnswers.indexOf(t);if(-1!==n&&o.userAnswers.splice(n,1),o.behaviour.autoCheck&&!o.behaviour.enableRetry)return;e.removeClass("h5p-selected").attr("aria-checked","false")}else o.userAnswers.push(t),e.addClass("h5p-selected").attr("aria-checked","true");y()}r.triggerXAPI("interacted"),g(e),o.userAnswers.length&&(r.showButton("check-answer"),r.hideButton("try-again"),r.hideButton("show-solution"),o.behaviour.autoCheck&&(o.behaviour.singleAnswer?A():(r.showCheckSolution(!0),b===r.getMaxScore()&&A())))}};h.click((function(){l(s(this))})).keydown((function(e){if(32===e.keyCode)return l(s(this)),!1;if(o.behaviour.singleAnswer)switch(e.keyCode){case 38:case 37:var t=s(this).prev();return t.length&&l(t.focus()),!1;case 40:case 39:var n=s(this).next();return n.length&&l(n.focus()),!1}})),o.behaviour.singleAnswer&&h.focus((function(){"true"!==s(this).attr("aria-disabled")&&h.not(this).attr("tabindex","-1")})).blur((function(){h.filter(".h5p-selected").length||h.first().add(h.last()).attr("tabindex","0")})),S(),o.behaviour.singleAnswer?b=o.userAnswers.length&&o.answers[o.userAnswers[0]].correct?1:0:y(),R&&o.behaviour.autoCheck&&(o.behaviour.singleAnswer||b===r.getMaxScore()?A():r.showCheckSolution(!0))},this.showAllSolutions=function(){v||(v=!0,d.find(".h5p-answer").each((function(e,t){var n=s(t);o.answers[e].correct?n.addClass("h5p-should").append(s("<span/>",{class:"h5p-solution-icon",html:o.UI.shouldCheck+"."})):n.addClass("h5p-should-not").append(s("<span/>",{class:"h5p-solution-icon",html:o.UI.shouldNotCheck+"."}))})).find(".h5p-question-plus-one, .h5p-question-minus-one").remove(),C(),d.find(".h5p-answer.h5p-should").first().focus(),r.hideButton("check-answer"),r.hideButton("show-solution"),o.behaviour.enableRetry&&r.showButton("try-again"),r.trigger("resize"))},this.showSolutions=function(){w(),r.showCheckSolution(),r.showAllSolutions(),C(),r.hideButton("try-again")};var g=function(e){e.removeClass("h5p-correct").removeClass("h5p-wrong").removeClass("h5p-should").removeClass("h5p-should-not").removeClass("h5p-has-feedback").find(".h5p-question-plus-one, .h5p-question-minus-one, .h5p-answer-icon, .h5p-solution-icon, .h5p-feedback-dialog").remove()};this.hideSolutions=function(){v=!1,g(s(".h5p-answer",d)),this.removeFeedback(),r.trigger("resize")},this.resetTask=function(){r.answered=!1,r.hideSolutions(),o.userAnswers=[],I(),r.showButton("check-answer"),r.hideButton("try-again"),r.hideButton("show-solution"),x(),d.find(".h5p-feedback-available").remove()};var k=function(){if(u)return o.weight;for(var e=0,t=0;t<o.answers.length;t++){var n=o.answers[t];n.correct&&(e+=void 0!==n.weight?n.weight:1)}return e};this.getMaxScore=function(){return o.behaviour.singleAnswer||o.behaviour.singlePoint?o.weight:k()};var A=function(){d.unbind("click",w),w(),o.behaviour.enableSolutionsButton&&r.showButton("show-solution"),o.behaviour.enableRetry&&r.showButton("try-again"),r.hideButton("check-answer"),r.showCheckSolution(),C();var e=r.createXAPIEventTemplate("answered");B(e),F(e),r.trigger(e)},S=function(){var e,t=s('[data-content-id="'+r.contentId+'"].h5p-content'),n=t.parents(".h5p-container");e=0!==n.length?n.last():0!==t.length?t:s(document.body),r.addButton("show-solution",o.UI.showSolutionButton,(function(){o.behaviour.showSolutionsRequiresInput&&!s('.h5p-answer[aria-checked="true"]',d).length?(r.updateFeedbackContent(o.UI.noInput),r.read(o.UI.noInput)):(y(),r.showAllSolutions())}),!1,{"aria-label":o.UI.a11yShowSolution}),!o.behaviour.enableCheckButton||o.behaviour.autoCheck&&o.behaviour.singleAnswer||r.addButton("check-answer",o.UI.checkAnswerButton,(function(){r.answered=!0,A()}),!0,{"aria-label":o.UI.a11yCheck},{confirmationDialog:{enable:o.behaviour.confirmCheckDialog,l10n:o.confirmCheck,instance:r,$parentElement:e},contentData:r.contentData,textIfSubmitting:o.UI.submitAnswerButton}),r.addButton("try-again",o.UI.tryAgainButton,(function(){if(r.resetTask(),o.behaviour.randomAnswers){var e=M;M=P();var t=d.find(".h5p-answer"),n=[];for(h=0;h<t.length;h++)n[h]=s(t[h]).find(".h5p-MultiChoiceScore4LMS-tipwrap");for(h=0;h<t.length;h++)s(t[h]).find(".h5p-alternative-inner").html(o.answers[h].text),s(n[h]).detach().appendTo(s(t[M.indexOf(e[h])]).find(".h5p-alternative-container"))}}),!1,{"aria-label":o.UI.a11yRetry},{confirmationDialog:{enable:o.behaviour.confirmRetryDialog,l10n:o.confirmRetry,instance:r,$parentElement:e}})},m=function(e,t){f(e,t);var n=s("<div/>",{class:"h5p-hidden-read h5p-feedback-available","aria-label":o.UI.feedbackAvailable+"."});s("<div/>",{role:"button",tabindex:0,"aria-label":o.UI.readFeedback+".",appendTo:n,on:{keydown:function(e){if(32===e.which)return r.read(t),!1}}}),n.appendTo(e)};this.showCheckSolution=function(t){var n;o.behaviour.singleAnswer||o.behaviour.singlePoint||!o.behaviour.showScorePoints||(n=new e.Question.ScorePoints),d.find(".h5p-answer").each((function(e,a){var r=s(a),i=o.answers[e],c="true"===r.attr("aria-checked");if(c&&(i.correct?r.hasClass("h5p-correct")||r.addClass("h5p-correct").append(s("<span/>",{class:"h5p-answer-icon",html:o.UI.correctAnswer+"."})):r.hasClass("h5p-wrong")||r.addClass("h5p-wrong").append(s("<span/>",{class:"h5p-answer-icon",html:o.UI.wrongAnswer+"."})),n)){var h=r[0].querySelector(".h5p-alternative-container");o.behaviour.autoCheck&&null!==h.querySelector(".h5p-question-plus-one, .h5p-question-minus-one")||h.appendChild(n.getElement(i.correct))}t||(c&&void 0!==i.tipsAndFeedback.chosenFeedback&&""!==i.tipsAndFeedback.chosenFeedback?m(r,i.tipsAndFeedback.chosenFeedback):c||void 0===i.tipsAndFeedback.notChosenFeedback||""===i.tipsAndFeedback.notChosenFeedback||m(r,i.tipsAndFeedback.notChosenFeedback))}));var a=r.getMaxScore();b===a&&(r.hideButton("check-answer"),r.hideButton("try-again"),r.hideButton("show-solution")),t||this.setFeedback(function(t,n){var a=t/n;return e.Question.determineOverallFeedback(o.overallFeedback,a).replace("@score",t).replace("@total",n)}(b,a),b,a,o.UI.scoreBarLabel),r.trigger("resize")};var C=function(){s(".h5p-answer",d).attr({"aria-disabled":"true",tabindex:"-1"})},x=function(){s(".h5p-answer",d).attr("aria-disabled","false")},y=function(){b=0;for(const e of o.userAnswers){const t=o.answers[e],n=void 0!==t.weight?t.weight:1;t.correct?b+=n:b-=n}b<0&&(b=0),!o.userAnswers.length&&u&&(b=o.weight),o.behaviour.singlePoint&&(b=100*b/k()>=o.behaviour.passPercentage?o.weight:0)},I=function(){var e=s(".h5p-answer",d).removeClass("h5p-selected").attr("aria-checked","false");o.behaviour.singleAnswer?e.first().attr("tabindex","0"):e.attr("tabindex","0"),e.first().focus(),y()};this.getXAPIData=function(){var e=this.createXAPIEventTemplate("answered");return B(e),F(e),{statement:e.data.statement}};var M,B=function(e){var t=e.getVerifiedStatementValue(["object","definition"]);t.description={"en-US":s("<div>"+o.question+"</div>").text()},t.type="http://adlnet.gov/expapi/activities/cmi.interaction",t.interactionType="choice",t.correctResponsesPattern=[],t.choices=[];for(var n=0;n<o.answers.length;n++)t.choices[n]={id:o.answers[n].originalOrder+"",description:{"en-US":s("<div>"+o.answers[n].text+"</div>").text()}},o.answers[n].correct&&(o.singleAnswer?t.correctResponsesPattern.push(""+o.answers[n].originalOrder):(t.correctResponsesPattern.length?t.correctResponsesPattern[0]+="[,]":t.correctResponsesPattern.push(""),t.correctResponsesPattern[0]+=o.answers[n].originalOrder))},F=function(e){var t=r.getMaxScore(),n=100*b/t>=o.behaviour.passPercentage;e.setScoredResult(b,t,r,!0,n),void 0===o.userAnswers&&y();for(var a="",s=0;s<o.userAnswers.length;s++)""!==a&&(a+="[,]"),a+=void 0===M?o.userAnswers[s]:M[o.userAnswers[s]];e.data.statement.result.response=a},P=function(){o.answers=e.shuffleArray(o.answers);var t=[];for(h=0;h<o.answers.length;h++)t[h]=o.answers[h].originalOrder;return t};for(h=0;h<o.answers.length;h++)o.answers[h].originalOrder=h;if(o.behaviour.randomAnswers&&(M=P()),o.userAnswers=[],a&&void 0!==a.previousState&&a.previousState.answers){if(M)for(h=0;h<a.previousState.answers.length;h++)for(var U=0;U<M.length;U++)M[U]===a.previousState.answers[h]&&o.userAnswers.push(U);else o.userAnswers=a.previousState.answers;y()}for(var R=!1,L=0;L<o.answers.length;L++){var T=o.answers[L];o.behaviour.singleAnswer?(T.role="radio",0===o.userAnswers.length?0!==h&&h!==o.answers.length||(T.tabindex="0"):-1!==o.userAnswers.indexOf(L)&&(T.tabindex="0",T.checked="true",R=!0)):(T.role="checkbox",T.tabindex="0",-1!==o.userAnswers.indexOf(L)&&(T.checked="true",R=!0)),void 0===T.tabindex&&(T.tabindex="-1"),void 0===T.checked&&(T.checked="false")}e.MultiChoiceScore4LMS.counter=void 0===e.MultiChoiceScore4LMS.counter?0:e.MultiChoiceScore4LMS.counter+1,o.role=o.behaviour.singleAnswer?"radiogroup":"group",o.label="h5p-mcq"+e.MultiChoiceScore4LMS.counter,this.getCurrentState=function(){var e={};if(M){e.answers=[];for(var t=0;t<o.userAnswers.length;t++)e.answers.push(M[o.userAnswers[t]])}else e.answers=o.userAnswers;return e},this.getAnswerGiven=function(e){return!e&&this.answered||o.userAnswers.length>0||u},this.getScore=function(){return b},this.getTitle=function(){return e.createTitle(this.contentData&&this.contentData.metadata&&this.contentData.metadata.title?this.contentData.metadata.title:"Multiple Choice")}},e.MultiChoiceScore4LMS.prototype=Object.create(e.Question.prototype),e.MultiChoiceScore4LMS.prototype.constructor=e.MultiChoiceScore4LMS})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QkFBcUI0TyxVQUFVRyxZQUFjaFAsRUFBSUMsc0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zNGxtcy8uL2pzL211bHRpY2hvaWNlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qZ2xvYmFsIEVKUyovXG4vLyBXaWxsIHJlbmRlciBhIFF1ZXN0aW9uIHdpdGggbXVsdGlwbGUgY2hvaWNlcyBmb3IgYW5zd2Vycy5cblxuLy8gT3B0aW9ucyBmb3JtYXQ6XG4vLyB7XG4vLyAgIHRpdGxlOiBcIk9wdGlvbmFsIHRpdGxlIGZvciBxdWVzdGlvbiBib3hcIixcbi8vICAgcXVlc3Rpb246IFwiUXVlc3Rpb24gdGV4dFwiLFxuLy8gICBhbnN3ZXJzOiBbe3RleHQ6IFwiQW5zd2VyIHRleHRcIiwgY29ycmVjdDogZmFsc2V9LCAuLi5dLFxuLy8gICBzaW5nbGVBbnN3ZXI6IHRydWUsIC8vIG9yIGZhbHNlLCB3aWxsIGNoYW5nZSByZW5kZXJlZCBvdXRwdXQgc2xpZ2h0bHkuXG4vLyAgIHNpbmdsZVBvaW50OiB0cnVlLCAgLy8gVHJ1ZSBpZiBxdWVzdGlvbiBnaXZlIGEgc2luZ2xlIHBvaW50IHNjb3JlIG9ubHlcbi8vICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiBhbGwgYXJlIGNvcnJlY3QsIGZhbHNlIHRvIGdpdmUgMSBwb2ludCBwZXJcbi8vICAgICAgICAgICAgICAgICAgICAgICAvLyBjb3JyZWN0IGFuc3dlci4gKE9ubHkgZm9yIHNpbmdsZUFuc3dlcj1mYWxzZSlcbi8vICAgcmFuZG9tQW5zd2VyczogZmFsc2UgIC8vIFdoZXRoZXIgdG8gcmFuZG9taXplIHRoZSBvcmRlciBvZiBhbnN3ZXJzLlxuLy8gfVxuLy9cbi8vIEV2ZW50cyBwcm92aWRlZDpcbi8vIC0gaDVwUXVlc3Rpb25BbnN3ZXJlZDogVHJpZ2dlcmVkIHdoZW4gYSBxdWVzdGlvbiBoYXMgYmVlbiBhbnN3ZXJlZC5cblxudmFyIEg1UCA9IEg1UCB8fCB7fTtcblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBPcHRpb25zXG4gKiAgIE9wdGlvbnMgZm9yIG11bHRpcGxlIGNob2ljZVxuICpcbiAqIEBwcm9wZXJ0eSB7T2JqZWN0fSBiZWhhdmlvdXJcbiAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gYmVoYXZpb3VyLmNvbmZpcm1DaGVja0RpYWxvZ1xuICogQHByb3BlcnR5IHtib29sZWFufSBiZWhhdmlvdXIuY29uZmlybVJldHJ5RGlhbG9nXG4gKlxuICogQHByb3BlcnR5IHtPYmplY3R9IFVJXG4gKiBAcHJvcGVydHkge3N0cmluZ30gVUkudGlwc0xhYmVsXG4gKlxuICogQHByb3BlcnR5IHtPYmplY3R9IFtjb25maXJtUmV0cnldXG4gKiBAcHJvcGVydHkge3N0cmluZ30gW2NvbmZpcm1SZXRyeS5oZWFkZXJdXG4gKiBAcHJvcGVydHkge3N0cmluZ30gW2NvbmZpcm1SZXRyeS5ib2R5XVxuICogQHByb3BlcnR5IHtzdHJpbmd9IFtjb25maXJtUmV0cnkuY2FuY2VsTGFiZWxdXG4gKiBAcHJvcGVydHkge3N0cmluZ30gW2NvbmZpcm1SZXRyeS5jb25maXJtTGFiZWxdXG4gKlxuICogQHByb3BlcnR5IHtPYmplY3R9IFtjb25maXJtQ2hlY2tdXG4gKiBAcHJvcGVydHkge3N0cmluZ30gW2NvbmZpcm1DaGVjay5oZWFkZXJdXG4gKiBAcHJvcGVydHkge3N0cmluZ30gW2NvbmZpcm1DaGVjay5ib2R5XVxuICogQHByb3BlcnR5IHtzdHJpbmd9IFtjb25maXJtQ2hlY2suY2FuY2VsTGFiZWxdXG4gKiBAcHJvcGVydHkge3N0cmluZ30gW2NvbmZpcm1DaGVjay5jb25maXJtTGFiZWxdXG4gKi9cblxuLyoqXG4gKiBNb2R1bGUgZm9yIGNyZWF0aW5nIGEgbXVsdGlwbGUgY2hvaWNlIHF1ZXN0aW9uXG4gKlxuICogQHBhcmFtIHtPcHRpb25zfSBvcHRpb25zXG4gKiBAcGFyYW0ge251bWJlcn0gY29udGVudElkXG4gKiBAcGFyYW0ge09iamVjdH0gY29udGVudERhdGFcbiAqIEByZXR1cm5zIHtINVAuTXVsdGlDaG9pY2VTY29yZTRMTVN9XG4gKiBAY29uc3RydWN0b3JcbiAqL1xuSDVQLk11bHRpQ2hvaWNlU2NvcmU0TE1TID0gZnVuY3Rpb24gKG9wdGlvbnMsIGNvbnRlbnRJZCwgY29udGVudERhdGEpIHtcbiAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIEg1UC5NdWx0aUNob2ljZVNjb3JlNExNUykpXG4gICAgcmV0dXJuIG5ldyBINVAuTXVsdGlDaG9pY2VTY29yZTRMTVMob3B0aW9ucywgY29udGVudElkLCBjb250ZW50RGF0YSk7XG4gIHZhciBzZWxmID0gdGhpcztcbiAgdGhpcy5jb250ZW50SWQgPSBjb250ZW50SWQ7XG4gIHRoaXMuY29udGVudERhdGEgPSBjb250ZW50RGF0YTtcbiAgSDVQLlF1ZXN0aW9uLmNhbGwoc2VsZiwgJ011bHRpQ2hvaWNlU2NvcmU0TE1TJyk7XG4gIHZhciAkID0gSDVQLmpRdWVyeTtcblxuICAvLyBjaGVja2JveCBvciByYWRpb2J1dHRvblxuICB2YXIgdGV4dHRlbXBsYXRlID1cbiAgICAnPHVsIGNsYXNzPVwiaDVwLWFuc3dlcnNcIiByb2xlPVwiPCU9IHJvbGUgJT5cIiBhcmlhLWxhYmVsbGVkYnk9XCI8JT0gbGFiZWwgJT5cIj4nICtcbiAgICAnICA8JSBmb3IgKHZhciBpPTA7IGkgPCBhbnN3ZXJzLmxlbmd0aDsgaSsrKSB7ICU+JyArXG4gICAgJyAgICA8bGkgY2xhc3M9XCJoNXAtYW5zd2VyXCIgcm9sZT1cIjwlPSBhbnN3ZXJzW2ldLnJvbGUgJT5cIiB0YWJpbmRleD1cIjwlPSBhbnN3ZXJzW2ldLnRhYmluZGV4ICU+XCIgYXJpYS1jaGVja2VkPVwiPCU9IGFuc3dlcnNbaV0uY2hlY2tlZCAlPlwiIGRhdGEtaWQ9XCI8JT0gaSAlPlwiPicgK1xuICAgICcgICAgICA8ZGl2IGNsYXNzPVwiaDVwLWFsdGVybmF0aXZlLWNvbnRhaW5lclwiPicgK1xuICAgICcgICAgICAgIDxzcGFuIGNsYXNzPVwiaDVwLWFsdGVybmF0aXZlLWlubmVyXCI+PCU9IGFuc3dlcnNbaV0udGV4dCAlPjwvc3Bhbj4nICtcbiAgICAnICAgICAgPC9kaXY+JyArXG4gICAgJyAgICAgIDxkaXYgY2xhc3M9XCJoNXAtY2xlYXJmaXhcIj48L2Rpdj4nICtcbiAgICAnICAgIDwvbGk+JyArXG4gICAgJyAgPCUgfSAlPicgK1xuICAgICc8L3VsPic7XG5cbiAgdmFyIGRlZmF1bHRzID0ge1xuICAgIGltYWdlOiBudWxsLFxuICAgIHF1ZXN0aW9uOiBcIk5vIHF1ZXN0aW9uIHRleHQgcHJvdmlkZWRcIixcbiAgICBhbnN3ZXJzOiBbXG4gICAgICB7XG4gICAgICAgIHRpcHNBbmRGZWVkYmFjazoge1xuICAgICAgICAgIHRpcDogJycsXG4gICAgICAgICAgY2hvc2VuRmVlZGJhY2s6ICcnLFxuICAgICAgICAgIG5vdENob3NlbkZlZWRiYWNrOiAnJ1xuICAgICAgICB9LFxuICAgICAgICB0ZXh0OiBcIkFuc3dlciAxXCIsXG4gICAgICAgIGNvcnJlY3Q6IHRydWVcbiAgICAgIH1cbiAgICBdLFxuICAgIG92ZXJhbGxGZWVkYmFjazogW10sXG4gICAgd2VpZ2h0OiAxLFxuICAgIHVzZXJBbnN3ZXJzOiBbXSxcbiAgICBVSToge1xuICAgICAgY2hlY2tBbnN3ZXJCdXR0b246ICdDaGVjaycsXG4gICAgICBzdWJtaXRBbnN3ZXJCdXR0b246ICdTdWJtaXQnLFxuICAgICAgc2hvd1NvbHV0aW9uQnV0dG9uOiAnU2hvdyBzb2x1dGlvbicsXG4gICAgICB0cnlBZ2FpbkJ1dHRvbjogJ1RyeSBhZ2FpbicsXG4gICAgICBzY29yZUJhckxhYmVsOiAnWW91IGdvdCA6bnVtIG91dCBvZiA6dG90YWwgcG9pbnRzJyxcbiAgICAgIHRpcEF2YWlsYWJsZTogXCJUaXAgYXZhaWxhYmxlXCIsXG4gICAgICBmZWVkYmFja0F2YWlsYWJsZTogXCJGZWVkYmFjayBhdmFpbGFibGVcIixcbiAgICAgIHJlYWRGZWVkYmFjazogJ1JlYWQgZmVlZGJhY2snLFxuICAgICAgc2hvdWxkQ2hlY2s6IFwiU2hvdWxkIGhhdmUgYmVlbiBjaGVja2VkXCIsXG4gICAgICBzaG91bGROb3RDaGVjazogXCJTaG91bGQgbm90IGhhdmUgYmVlbiBjaGVja2VkXCIsXG4gICAgICBub0lucHV0OiAnSW5wdXQgaXMgcmVxdWlyZWQgYmVmb3JlIHZpZXdpbmcgdGhlIHNvbHV0aW9uJyxcbiAgICAgIGExMXlDaGVjazogJ0NoZWNrIHRoZSBhbnN3ZXJzLiBUaGUgcmVzcG9uc2VzIHdpbGwgYmUgbWFya2VkIGFzIGNvcnJlY3QsIGluY29ycmVjdCwgb3IgdW5hbnN3ZXJlZC4nLFxuICAgICAgYTExeVNob3dTb2x1dGlvbjogJ1Nob3cgdGhlIHNvbHV0aW9uLiBUaGUgdGFzayB3aWxsIGJlIG1hcmtlZCB3aXRoIGl0cyBjb3JyZWN0IHNvbHV0aW9uLicsXG4gICAgICBhMTF5UmV0cnk6ICdSZXRyeSB0aGUgdGFzay4gUmVzZXQgYWxsIHJlc3BvbnNlcyBhbmQgc3RhcnQgdGhlIHRhc2sgb3ZlciBhZ2Fpbi4nLFxuICAgIH0sXG4gICAgYmVoYXZpb3VyOiB7XG4gICAgICBlbmFibGVSZXRyeTogdHJ1ZSxcbiAgICAgIGVuYWJsZVNvbHV0aW9uc0J1dHRvbjogdHJ1ZSxcbiAgICAgIGVuYWJsZUNoZWNrQnV0dG9uOiB0cnVlLFxuICAgICAgdHlwZTogJ2F1dG8nLFxuICAgICAgc2luZ2xlUG9pbnQ6IHRydWUsXG4gICAgICByYW5kb21BbnN3ZXJzOiBmYWxzZSxcbiAgICAgIHNob3dTb2x1dGlvbnNSZXF1aXJlc0lucHV0OiB0cnVlLFxuICAgICAgYXV0b0NoZWNrOiBmYWxzZSxcbiAgICAgIHBhc3NQZXJjZW50YWdlOiAxMDAsXG4gICAgICBzaG93U2NvcmVQb2ludHM6IHRydWVcbiAgICB9XG4gIH07XG4gIHZhciB0ZW1wbGF0ZSA9IG5ldyBFSlMoe3RleHQ6IHRleHR0ZW1wbGF0ZX0pO1xuICB2YXIgcGFyYW1zID0gJC5leHRlbmQodHJ1ZSwgZGVmYXVsdHMsIG9wdGlvbnMpO1xuICAvLyBLZWVwIHRyYWNrIG9mIG51bWJlciBvZiBjb3JyZWN0IGNob2ljZXNcbiAgdmFyIG51bUNvcnJlY3QgPSAwO1xuXG4gIC8vIExvb3AgdGhyb3VnaCBjaG9pY2VzXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgcGFyYW1zLmFuc3dlcnMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgYW5zd2VyID0gcGFyYW1zLmFuc3dlcnNbaV07XG5cbiAgICAvLyBNYWtlIHN1cmUgdGlwcyBhbmQgZmVlZGJhY2sgZXhpc3RzXG4gICAgYW5zd2VyLnRpcHNBbmRGZWVkYmFjayA9IGFuc3dlci50aXBzQW5kRmVlZGJhY2sgfHwge307XG5cbiAgICBpZiAocGFyYW1zLmFuc3dlcnNbaV0uY29ycmVjdCkge1xuICAgICAgLy8gVXBkYXRlIG51bWJlciBvZiBjb3JyZWN0IGNob2ljZXNcbiAgICAgIG51bUNvcnJlY3QrKztcbiAgICB9XG4gIH1cblxuICAvLyBEZXRlcm1pbmUgaWYgbm8gY2hvaWNlcyBpcyB0aGUgY29ycmVjdFxuICB2YXIgYmxhbmtJc0NvcnJlY3QgPSAobnVtQ29ycmVjdCA9PT0gMCk7XG5cbiAgLy8gRGV0ZXJtaW5lIHRhc2sgdHlwZVxuICBpZiAocGFyYW1zLmJlaGF2aW91ci50eXBlID09PSAnYXV0bycpIHtcbiAgICAvLyBVc2Ugc2luZ2xlIGNob2ljZSBpZiBvbmx5IG9uZSBjaG9pY2UgaXMgY29ycmVjdFxuICAgIHBhcmFtcy5iZWhhdmlvdXIuc2luZ2xlQW5zd2VyID0gKG51bUNvcnJlY3QgPT09IDEpO1xuICB9XG4gIGVsc2Uge1xuICAgIHBhcmFtcy5iZWhhdmlvdXIuc2luZ2xlQW5zd2VyID0gKHBhcmFtcy5iZWhhdmlvdXIudHlwZSA9PT0gJ3NpbmdsZScpO1xuICB9XG5cbiAgdmFyIGdldENoZWNrYm94T3JSYWRpb0ljb24gPSBmdW5jdGlvbiAocmFkaW8sIHNlbGVjdGVkKSB7XG4gICAgdmFyIGljb247XG4gICAgaWYgKHJhZGlvKSB7XG4gICAgICBpY29uID0gc2VsZWN0ZWQgPyAnJiN4ZTYwMzsnIDogJyYjeGU2MDA7JztcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICBpY29uID0gc2VsZWN0ZWQgPyAnJiN4ZTYwMTsnIDogJyYjeGU2MDI7JztcbiAgICB9XG4gICAgcmV0dXJuIGljb247XG4gIH07XG5cbiAgLy8gSW5pdGlhbGl6ZSBidXR0b25zIGFuZCBlbGVtZW50cy5cbiAgdmFyICRteURvbTtcbiAgdmFyICRmZWVkYmFja0RpYWxvZztcblxuICAvKipcbiAgICogUmVtb3ZlIGFsbCBmZWVkYmFjayBkaWFsb2dzXG4gICAqL1xuICB2YXIgcmVtb3ZlRmVlZGJhY2tEaWFsb2cgPSBmdW5jdGlvbiAoKSB7XG4gICAgLy8gUmVtb3ZlIHRoZSBvcGVuIGZlZWRiYWNrIGRpYWxvZ3MuXG4gICAgJG15RG9tLnVuYmluZCgnY2xpY2snLCByZW1vdmVGZWVkYmFja0RpYWxvZyk7XG4gICAgJG15RG9tLmZpbmQoJy5oNXAtZmVlZGJhY2stYnV0dG9uLCAuaDVwLWZlZWRiYWNrLWRpYWxvZycpLnJlbW92ZSgpO1xuICAgICRteURvbS5maW5kKCcuaDVwLWhhcy1mZWVkYmFjaycpLnJlbW92ZUNsYXNzKCdoNXAtaGFzLWZlZWRiYWNrJyk7XG4gICAgaWYgKCRmZWVkYmFja0RpYWxvZykge1xuICAgICAgJGZlZWRiYWNrRGlhbG9nLnJlbW92ZSgpO1xuICAgIH1cbiAgfTtcblxuICB2YXIgc2NvcmUgPSAwO1xuICB2YXIgc29sdXRpb25zVmlzaWJsZSA9IGZhbHNlO1xuXG4gIC8qKlxuICAgKiBBZGQgZmVlZGJhY2sgdG8gZWxlbWVudFxuICAgKiBAcGFyYW0ge2pRdWVyeX0gJGVsZW1lbnQgRWxlbWVudCB0aGF0IGZlZWRiYWNrIHdpbGwgYmUgYWRkZWQgdG9cbiAgICogQHBhcmFtIHtzdHJpbmd9IGZlZWRiYWNrIEZlZWRiYWNrIHN0cmluZ1xuICAgKi9cbiAgdmFyIGFkZEZlZWRiYWNrID0gZnVuY3Rpb24gKCRlbGVtZW50LCBmZWVkYmFjaykge1xuICAgICRmZWVkYmFja0RpYWxvZyA9ICQoJycgK1xuICAgICc8ZGl2IGNsYXNzPVwiaDVwLWZlZWRiYWNrLWRpYWxvZ1wiPicgK1xuICAgICAgJzxkaXYgY2xhc3M9XCJoNXAtZmVlZGJhY2staW5uZXJcIj4nICtcbiAgICAgICAgJzxkaXYgY2xhc3M9XCJoNXAtZmVlZGJhY2stdGV4dFwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPicgKyBmZWVkYmFjayArICc8L2Rpdj4nICtcbiAgICAgICc8L2Rpdj4nICtcbiAgICAnPC9kaXY+Jyk7XG5cbiAgICAvL21ha2Ugc3VyZSBmZWVkYmFjayBpcyBvbmx5IGFkZGVkIG9uY2VcbiAgICBpZiAoISRlbGVtZW50LmZpbmQoJCgnLmg1cC1mZWVkYmFjay1kaWFsb2cnKSkubGVuZ3RoKSB7XG4gICAgICAkZmVlZGJhY2tEaWFsb2cuYXBwZW5kVG8oJGVsZW1lbnQuYWRkQ2xhc3MoJ2g1cC1oYXMtZmVlZGJhY2snKSk7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBSZWdpc3RlciB0aGUgZGlmZmVyZW50IHBhcnRzIG9mIHRoZSB0YXNrIHdpdGggdGhlIEg1UC5RdWVzdGlvbiBzdHJ1Y3R1cmUuXG4gICAqL1xuICBzZWxmLnJlZ2lzdGVyRG9tRWxlbWVudHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIG1lZGlhID0gcGFyYW1zLm1lZGlhO1xuICAgIGlmIChtZWRpYSAmJiBtZWRpYS50eXBlICYmIG1lZGlhLnR5cGUubGlicmFyeSkge1xuICAgICAgbWVkaWEgPSBtZWRpYS50eXBlO1xuICAgICAgdmFyIHR5cGUgPSBtZWRpYS5saWJyYXJ5LnNwbGl0KCcgJylbMF07XG4gICAgICBpZiAodHlwZSA9PT0gJ0g1UC5JbWFnZScpIHtcbiAgICAgICAgaWYgKG1lZGlhLnBhcmFtcy5maWxlKSB7XG4gICAgICAgICAgLy8gUmVnaXN0ZXIgdGFzayBpbWFnZVxuICAgICAgICAgIHNlbGYuc2V0SW1hZ2UobWVkaWEucGFyYW1zLmZpbGUucGF0aCwge1xuICAgICAgICAgICAgZGlzYWJsZUltYWdlWm9vbWluZzogcGFyYW1zLm1lZGlhLmRpc2FibGVJbWFnZVpvb21pbmcgfHwgZmFsc2UsXG4gICAgICAgICAgICBhbHQ6IG1lZGlhLnBhcmFtcy5hbHQsXG4gICAgICAgICAgICB0aXRsZTogbWVkaWEucGFyYW1zLnRpdGxlXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKHR5cGUgPT09ICdINVAuVmlkZW8nKSB7XG4gICAgICAgIGlmIChtZWRpYS5wYXJhbXMuc291cmNlcykge1xuICAgICAgICAgIC8vIFJlZ2lzdGVyIHRhc2sgdmlkZW9cbiAgICAgICAgICBzZWxmLnNldFZpZGVvKG1lZGlhKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgZWxzZSBpZiAodHlwZSA9PT0gJ0g1UC5BdWRpbycpIHtcbiAgICAgICAgaWYgKG1lZGlhLnBhcmFtcy5maWxlcykge1xuICAgICAgICAgIC8vIFJlZ2lzdGVyIHRhc2sgYXVkaW9cbiAgICAgICAgICBzZWxmLnNldEF1ZGlvKG1lZGlhKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIERldGVybWluZSBpZiB3ZSdyZSB1c2luZyBjaGVja2JveGVzIG9yIHJhZGlvIGJ1dHRvbnNcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBhcmFtcy5hbnN3ZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBwYXJhbXMuYW5zd2Vyc1tpXS5jaGVja2JveE9yUmFkaW9JY29uID0gZ2V0Q2hlY2tib3hPclJhZGlvSWNvbihwYXJhbXMuYmVoYXZpb3VyLnNpbmdsZUFuc3dlciwgcGFyYW1zLnVzZXJBbnN3ZXJzLmluZGV4T2YoaSkgPiAtMSk7XG4gICAgfVxuXG4gICAgLy8gUmVnaXN0ZXIgSW50cm9kdWN0aW9uXG4gICAgc2VsZi5zZXRJbnRyb2R1Y3Rpb24oJzxkaXYgaWQ9XCInICsgcGFyYW1zLmxhYmVsICsgJ1wiPicgKyBwYXJhbXMucXVlc3Rpb24gKyAnPC9kaXY+Jyk7XG5cbiAgICAvLyBSZWdpc3RlciB0YXNrIGNvbnRlbnQgYXJlYVxuICAgICRteURvbSA9ICQodGVtcGxhdGUucmVuZGVyKHBhcmFtcykpO1xuICAgIHNlbGYuc2V0Q29udGVudCgkbXlEb20sIHtcbiAgICAgICdjbGFzcyc6IHBhcmFtcy5iZWhhdmlvdXIuc2luZ2xlQW5zd2VyID8gJ2g1cC1yYWRpbycgOiAnaDVwLWNoZWNrJ1xuICAgIH0pO1xuXG4gICAgLy8gQ3JlYXRlIHRpcHM6XG4gICAgdmFyICRhbnN3ZXJzID0gJCgnLmg1cC1hbnN3ZXInLCAkbXlEb20pLmVhY2goZnVuY3Rpb24gKGkpIHtcblxuICAgICAgdmFyIHRpcCA9IHBhcmFtcy5hbnN3ZXJzW2ldLnRpcHNBbmRGZWVkYmFjay50aXA7XG4gICAgICBpZiAodGlwID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuOyAvLyBObyB0aXBcbiAgICAgIH1cblxuICAgICAgdGlwID0gdGlwLnRyaW0oKTtcbiAgICAgIHZhciB0aXBDb250ZW50ID0gdGlwXG4gICAgICAgIC5yZXBsYWNlKC8mbmJzcDsvZywgJycpXG4gICAgICAgIC5yZXBsYWNlKC88cD4vZywgJycpXG4gICAgICAgIC5yZXBsYWNlKC88XFwvcD4vZywgJycpXG4gICAgICAgIC50cmltKCk7XG4gICAgICBpZiAoIXRpcENvbnRlbnQubGVuZ3RoKSB7XG4gICAgICAgIHJldHVybjsgLy8gRW1wdHkgdGlwXG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgJCh0aGlzKS5hZGRDbGFzcygnaDVwLWhhcy10aXAnKTtcbiAgICAgIH1cblxuICAgICAgLy8gQWRkIHRpcFxuICAgICAgdmFyICR3cmFwID0gJCgnPGRpdi8+Jywge1xuICAgICAgICAnY2xhc3MnOiAnaDVwLU11bHRpQ2hvaWNlU2NvcmU0TE1TLXRpcHdyYXAnLFxuICAgICAgICAnYXJpYS1sYWJlbCc6IHBhcmFtcy5VSS50aXBBdmFpbGFibGUgKyAnLidcbiAgICAgIH0pO1xuXG4gICAgICB2YXIgJE11bHRpQ2hvaWNlU2NvcmU0TE1TVGlwID0gJCgnPGRpdj4nLCB7XG4gICAgICAgICdyb2xlJzogJ2J1dHRvbicsXG4gICAgICAgICd0YWJpbmRleCc6IDAsXG4gICAgICAgICd0aXRsZSc6IHBhcmFtcy5VSS50aXBzTGFiZWwsXG4gICAgICAgICdhcmlhLWxhYmVsJzogcGFyYW1zLlVJLnRpcHNMYWJlbCxcbiAgICAgICAgJ2FyaWEtZXhwYW5kZWQnOiBmYWxzZSxcbiAgICAgICAgJ2NsYXNzJzogJ011bHRpQ2hvaWNlU2NvcmU0TE1TLXRpcCcsXG4gICAgICAgIGFwcGVuZFRvOiAkd3JhcFxuICAgICAgfSk7XG5cbiAgICAgIHZhciB0aXBJY29uSHRtbCA9ICc8c3BhbiBjbGFzcz1cImpvdWJlbC1pY29uLXRpcC1ub3JtYWxcIj4nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVwiaDVwLWljb24tc2hhZG93XCI+PC9zcGFuPicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJoNXAtaWNvbi1zcGVlY2gtYnViYmxlXCI+PC9zcGFuPicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJoNXAtaWNvbi1pbmZvXCI+PC9zcGFuPicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJzwvc3Bhbj4nO1xuXG4gICAgICAkTXVsdGlDaG9pY2VTY29yZTRMTVNUaXAuYXBwZW5kKHRpcEljb25IdG1sKTtcblxuICAgICAgJE11bHRpQ2hvaWNlU2NvcmU0TE1TVGlwLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyICR0aXBDb250YWluZXIgPSAkTXVsdGlDaG9pY2VTY29yZTRMTVNUaXAucGFyZW50cygnLmg1cC1hbnN3ZXInKTtcbiAgICAgICAgdmFyIG9wZW5GZWVkYmFjayA9ICEkdGlwQ29udGFpbmVyLmNoaWxkcmVuKCcuaDVwLWZlZWRiYWNrLWRpYWxvZycpLmlzKCRmZWVkYmFja0RpYWxvZyk7XG4gICAgICAgIHJlbW92ZUZlZWRiYWNrRGlhbG9nKCk7XG5cbiAgICAgICAgLy8gRG8gbm90IG9wZW4gZmVlZGJhY2sgaWYgaXQgd2FzIG9wZW5cbiAgICAgICAgaWYgKG9wZW5GZWVkYmFjaykge1xuICAgICAgICAgICRNdWx0aUNob2ljZVNjb3JlNExNU1RpcC5hdHRyKCdhcmlhLWV4cGFuZGVkJywgdHJ1ZSk7XG5cbiAgICAgICAgICAvLyBBZGQgdGlwIGRpYWxvZ1xuICAgICAgICAgIGFkZEZlZWRiYWNrKCR0aXBDb250YWluZXIsIHRpcCk7XG4gICAgICAgICAgJGZlZWRiYWNrRGlhbG9nLmFkZENsYXNzKCdoNXAtaGFzLXRpcCcpO1xuXG4gICAgICAgICAgLy8gVGlwIGZvciByZWFkc3BlYWtlclxuICAgICAgICAgIHNlbGYucmVhZCh0aXApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICRNdWx0aUNob2ljZVNjb3JlNExNU1RpcC5hdHRyKCdhcmlhLWV4cGFuZGVkJywgZmFsc2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgc2VsZi50cmlnZ2VyKCdyZXNpemUnKTtcblxuICAgICAgICAvLyBSZW1vdmUgdGlwIGRpYWxvZyBvbiBkb20gY2xpY2tcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgJG15RG9tLmNsaWNrKHJlbW92ZUZlZWRiYWNrRGlhbG9nKTtcbiAgICAgICAgfSwgMTAwKTtcblxuICAgICAgICAvLyBEbyBub3QgcHJvcGFnYXRlXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH0pLmtleWRvd24oZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgaWYgKGUud2hpY2ggPT09IDMyKSB7XG4gICAgICAgICAgJCh0aGlzKS5jbGljaygpO1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgICQoJy5oNXAtYWx0ZXJuYXRpdmUtY29udGFpbmVyJywgdGhpcykuYXBwZW5kKCR3cmFwKTtcbiAgICB9KTtcblxuICAgIC8vIFNldCBldmVudCBsaXN0ZW5lcnMuXG4gICAgdmFyIHRvZ2dsZUNoZWNrID0gZnVuY3Rpb24gKCRhbnMpIHtcbiAgICAgIGlmICgkYW5zLmF0dHIoJ2FyaWEtZGlzYWJsZWQnKSA9PT0gJ3RydWUnKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHNlbGYuYW5zd2VyZWQgPSB0cnVlO1xuICAgICAgdmFyIG51bSA9IHBhcnNlSW50KCRhbnMuZGF0YSgnaWQnKSk7XG4gICAgICBpZiAocGFyYW1zLmJlaGF2aW91ci5zaW5nbGVBbnN3ZXIpIHtcbiAgICAgICAgLy8gU3RvcmUgYW5zd2VyXG4gICAgICAgIHBhcmFtcy51c2VyQW5zd2VycyA9IFtudW1dO1xuXG4gICAgICAgIC8vIENhbGN1bGF0ZSBzY29yZVxuICAgICAgICBzY29yZSA9IChwYXJhbXMuYW5zd2Vyc1tudW1dLmNvcnJlY3QgPyAxIDogMCk7XG5cbiAgICAgICAgLy8gRGUtc2VsZWN0IHByZXZpb3VzIGFuc3dlclxuICAgICAgICAkYW5zd2Vycy5ub3QoJGFucykucmVtb3ZlQ2xhc3MoJ2g1cC1zZWxlY3RlZCcpLmF0dHIoJ3RhYmluZGV4JywgJy0xJykuYXR0cignYXJpYS1jaGVja2VkJywgJ2ZhbHNlJyk7XG5cbiAgICAgICAgLy8gU2VsZWN0IG5ldyBhbnN3ZXJcbiAgICAgICAgJGFucy5hZGRDbGFzcygnaDVwLXNlbGVjdGVkJykuYXR0cigndGFiaW5kZXgnLCAnMCcpLmF0dHIoJ2FyaWEtY2hlY2tlZCcsICd0cnVlJyk7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgaWYgKCRhbnMuYXR0cignYXJpYS1jaGVja2VkJykgPT09ICd0cnVlJykge1xuICAgICAgICAgIGNvbnN0IHBvcyA9IHBhcmFtcy51c2VyQW5zd2Vycy5pbmRleE9mKG51bSk7XG4gICAgICAgICAgaWYgKHBvcyAhPT0gLTEpIHtcbiAgICAgICAgICAgIHBhcmFtcy51c2VyQW5zd2Vycy5zcGxpY2UocG9zLCAxKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBEbyBub3QgYWxsb3cgdW4tY2hlY2tpbmcgd2hlbiByZXRyeSBkaXNhYmxlZCBhbmQgYXV0byBjaGVja1xuICAgICAgICAgIGlmIChwYXJhbXMuYmVoYXZpb3VyLmF1dG9DaGVjayAmJiAhcGFyYW1zLmJlaGF2aW91ci5lbmFibGVSZXRyeSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIFJlbW92ZSBjaGVja1xuICAgICAgICAgICRhbnMucmVtb3ZlQ2xhc3MoJ2g1cC1zZWxlY3RlZCcpLmF0dHIoJ2FyaWEtY2hlY2tlZCcsICdmYWxzZScpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIHBhcmFtcy51c2VyQW5zd2Vycy5wdXNoKG51bSk7XG4gICAgICAgICAgJGFucy5hZGRDbGFzcygnaDVwLXNlbGVjdGVkJykuYXR0cignYXJpYS1jaGVja2VkJywgJ3RydWUnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENhbGN1bGF0ZSBzY29yZVxuICAgICAgICBjYWxjU2NvcmUoKTtcbiAgICAgIH1cblxuICAgICAgc2VsZi50cmlnZ2VyWEFQSSgnaW50ZXJhY3RlZCcpO1xuICAgICAgaGlkZVNvbHV0aW9uKCRhbnMpO1xuXG4gICAgICBpZiAocGFyYW1zLnVzZXJBbnN3ZXJzLmxlbmd0aCkge1xuICAgICAgICBzZWxmLnNob3dCdXR0b24oJ2NoZWNrLWFuc3dlcicpO1xuICAgICAgICBzZWxmLmhpZGVCdXR0b24oJ3RyeS1hZ2FpbicpO1xuICAgICAgICBzZWxmLmhpZGVCdXR0b24oJ3Nob3ctc29sdXRpb24nKTtcblxuICAgICAgICBpZiAocGFyYW1zLmJlaGF2aW91ci5hdXRvQ2hlY2spIHtcbiAgICAgICAgICBpZiAocGFyYW1zLmJlaGF2aW91ci5zaW5nbGVBbnN3ZXIpIHtcbiAgICAgICAgICAgIC8vIE9ubHkgYSBzaW5nbGUgYW5zd2VyIGFsbG93ZWRcbiAgICAgICAgICAgIGNoZWNrQW5zd2VyKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gU2hvdyBmZWVkYmFjayBmb3Igc2VsZWN0ZWQgYWx0ZXJuYXRpdmVzXG4gICAgICAgICAgICBzZWxmLnNob3dDaGVja1NvbHV0aW9uKHRydWUpO1xuXG4gICAgICAgICAgICAvLyBBbHdheXMgZmluaXNoIHRhc2sgaWYgaXQgd2FzIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHlcbiAgICAgICAgICAgIGlmIChzY29yZSA9PT0gc2VsZi5nZXRNYXhTY29yZSgpKSB7XG4gICAgICAgICAgICAgIGNoZWNrQW5zd2VyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcblxuICAgICRhbnN3ZXJzLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgIHRvZ2dsZUNoZWNrKCQodGhpcykpO1xuICAgIH0pLmtleWRvd24oZnVuY3Rpb24gKGUpIHtcbiAgICAgIGlmIChlLmtleUNvZGUgPT09IDMyKSB7IC8vIFNwYWNlIGJhclxuICAgICAgICAvLyBTZWxlY3QgY3VycmVudCBpdGVtXG4gICAgICAgIHRvZ2dsZUNoZWNrKCQodGhpcykpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG5cbiAgICAgIGlmIChwYXJhbXMuYmVoYXZpb3VyLnNpbmdsZUFuc3dlcikge1xuICAgICAgICBzd2l0Y2ggKGUua2V5Q29kZSkge1xuICAgICAgICAgIGNhc2UgMzg6ICAgLy8gVXBcbiAgICAgICAgICBjYXNlIDM3OiB7IC8vIExlZnRcbiAgICAgICAgICAgIC8vIFRyeSB0byBzZWxlY3QgcHJldmlvdXMgaXRlbVxuICAgICAgICAgICAgdmFyICRwcmV2ID0gJCh0aGlzKS5wcmV2KCk7XG4gICAgICAgICAgICBpZiAoJHByZXYubGVuZ3RoKSB7XG4gICAgICAgICAgICAgIHRvZ2dsZUNoZWNrKCRwcmV2LmZvY3VzKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjYXNlIDQwOiAgIC8vIERvd25cbiAgICAgICAgICBjYXNlIDM5OiB7IC8vIFJpZ2h0XG4gICAgICAgICAgICAvLyBUcnkgdG8gc2VsZWN0IG5leHQgaXRlbVxuICAgICAgICAgICAgdmFyICRuZXh0ID0gJCh0aGlzKS5uZXh0KCk7XG4gICAgICAgICAgICBpZiAoJG5leHQubGVuZ3RoKSB7XG4gICAgICAgICAgICAgIHRvZ2dsZUNoZWNrKCRuZXh0LmZvY3VzKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaWYgKHBhcmFtcy5iZWhhdmlvdXIuc2luZ2xlQW5zd2VyKSB7XG4gICAgICAvLyBTcGVjaWFsIGZvY3VzIGhhbmRsZXIgZm9yIHJhZGlvIGJ1dHRvbnNcbiAgICAgICRhbnN3ZXJzLmZvY3VzKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCQodGhpcykuYXR0cignYXJpYS1kaXNhYmxlZCcpICE9PSAndHJ1ZScpIHtcbiAgICAgICAgICAkYW5zd2Vycy5ub3QodGhpcykuYXR0cigndGFiaW5kZXgnLCAnLTEnKTtcbiAgICAgICAgfVxuICAgICAgfSkuYmx1cihmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghJGFuc3dlcnMuZmlsdGVyKCcuaDVwLXNlbGVjdGVkJykubGVuZ3RoKSB7XG4gICAgICAgICAgJGFuc3dlcnMuZmlyc3QoKS5hZGQoJGFuc3dlcnMubGFzdCgpKS5hdHRyKCd0YWJpbmRleCcsICcwJyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIEFkZHMgY2hlY2sgYW5kIHJldHJ5IGJ1dHRvblxuICAgIGFkZEJ1dHRvbnMoKTtcbiAgICBpZiAoIXBhcmFtcy5iZWhhdmlvdXIuc2luZ2xlQW5zd2VyKSB7XG5cbiAgICAgIGNhbGNTY29yZSgpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIGlmIChwYXJhbXMudXNlckFuc3dlcnMubGVuZ3RoICYmIHBhcmFtcy5hbnN3ZXJzW3BhcmFtcy51c2VyQW5zd2Vyc1swXV0uY29ycmVjdCkge1xuICAgICAgICBzY29yZSA9IDE7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgc2NvcmUgPSAwO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEhhcyBhbnN3ZXJlZCB0aHJvdWdoIGF1dG8tY2hlY2sgaW4gYSBwcmV2aW91cyBzZXNzaW9uXG4gICAgaWYgKGhhc0NoZWNrZWRBbnN3ZXIgJiYgcGFyYW1zLmJlaGF2aW91ci5hdXRvQ2hlY2spIHtcblxuICAgICAgLy8gQ2hlY2sgYW5zd2VycyBpZiBhbnN3ZXIgaGFzIGJlZW4gZ2l2ZW4gb3IgbWF4IHNjb3JlIHJlYWNoZWRcbiAgICAgIGlmIChwYXJhbXMuYmVoYXZpb3VyLnNpbmdsZUFuc3dlciB8fCBzY29yZSA9PT0gc2VsZi5nZXRNYXhTY29yZSgpKSB7XG4gICAgICAgIGNoZWNrQW5zd2VyKCk7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgLy8gU2hvdyBmZWVkYmFjayBmb3IgY2hlY2tlZCBjaGVja2JveGVzXG4gICAgICAgIHNlbGYuc2hvd0NoZWNrU29sdXRpb24odHJ1ZSk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIHRoaXMuc2hvd0FsbFNvbHV0aW9ucyA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoc29sdXRpb25zVmlzaWJsZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBzb2x1dGlvbnNWaXNpYmxlID0gdHJ1ZTtcblxuICAgICRteURvbS5maW5kKCcuaDVwLWFuc3dlcicpLmVhY2goZnVuY3Rpb24gKGksIGUpIHtcbiAgICAgIHZhciAkZSA9ICQoZSk7XG4gICAgICB2YXIgYSA9IHBhcmFtcy5hbnN3ZXJzW2ldO1xuICAgICAgaWYgKGEuY29ycmVjdCkge1xuICAgICAgICAkZS5hZGRDbGFzcygnaDVwLXNob3VsZCcpLmFwcGVuZCgkKCc8c3Bhbi8+Jywge1xuICAgICAgICAgICdjbGFzcyc6ICdoNXAtc29sdXRpb24taWNvbicsXG4gICAgICAgICAgaHRtbDogcGFyYW1zLlVJLnNob3VsZENoZWNrICsgJy4nXG4gICAgICAgIH0pKTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICAkZS5hZGRDbGFzcygnaDVwLXNob3VsZC1ub3QnKS5hcHBlbmQoJCgnPHNwYW4vPicsIHtcbiAgICAgICAgICAnY2xhc3MnOiAnaDVwLXNvbHV0aW9uLWljb24nLFxuICAgICAgICAgIGh0bWw6IHBhcmFtcy5VSS5zaG91bGROb3RDaGVjayArICcuJ1xuICAgICAgICB9KSk7XG4gICAgICB9XG4gICAgfSkuZmluZCgnLmg1cC1xdWVzdGlvbi1wbHVzLW9uZSwgLmg1cC1xdWVzdGlvbi1taW51cy1vbmUnKS5yZW1vdmUoKTtcblxuICAgIC8vIE1ha2Ugc3VyZSBpbnB1dCBpcyBkaXNhYmxlZCBpbiBzb2x1dGlvbiBtb2RlXG4gICAgZGlzYWJsZUlucHV0KCk7XG5cbiAgICAvLyBNb3ZlIGZvY3VzIGJhY2sgdG8gdGhlIGZpcnN0IGNvcnJlY3QgYWx0ZXJuYXRpdmUgc28gdGhhdCB0aGUgdXNlciBiZWNvbWVzXG4gICAgLy8gYXdhcmUgdGhhdCB0aGUgc29sdXRpb24gaXMgYmVpbmcgc2hvd24uXG4gICAgJG15RG9tLmZpbmQoJy5oNXAtYW5zd2VyLmg1cC1zaG91bGQnKS5maXJzdCgpLmZvY3VzKCk7XG5cbiAgICAvL0hpZGUgYnV0dG9ucyBhbmQgcmV0cnkgZGVwZW5kaW5nIG9uIHNldHRpbmdzLlxuICAgIHNlbGYuaGlkZUJ1dHRvbignY2hlY2stYW5zd2VyJyk7XG4gICAgc2VsZi5oaWRlQnV0dG9uKCdzaG93LXNvbHV0aW9uJyk7XG4gICAgaWYgKHBhcmFtcy5iZWhhdmlvdXIuZW5hYmxlUmV0cnkpIHtcbiAgICAgIHNlbGYuc2hvd0J1dHRvbigndHJ5LWFnYWluJyk7XG4gICAgfVxuICAgIHNlbGYudHJpZ2dlcigncmVzaXplJyk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFVzZWQgaW4gY29udHJhY3RzLlxuICAgKiBTaG93cyB0aGUgc29sdXRpb24gZm9yIHRoZSB0YXNrIGFuZCBoaWRlcyBhbGwgYnV0dG9ucy5cbiAgICovXG4gIHRoaXMuc2hvd1NvbHV0aW9ucyA9IGZ1bmN0aW9uICgpIHtcbiAgICByZW1vdmVGZWVkYmFja0RpYWxvZygpO1xuICAgIHNlbGYuc2hvd0NoZWNrU29sdXRpb24oKTtcbiAgICBzZWxmLnNob3dBbGxTb2x1dGlvbnMoKTtcbiAgICBkaXNhYmxlSW5wdXQoKTtcbiAgICBzZWxmLmhpZGVCdXR0b24oJ3RyeS1hZ2FpbicpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBIaWRlIHNvbHV0aW9uIGZvciB0aGUgZ2l2ZW4gYW5zd2VyKHMpXG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqIEBwYXJhbSB7SDVQLmpRdWVyeX0gJGFuc3dlclxuICAgKi9cbiAgdmFyIGhpZGVTb2x1dGlvbiA9IGZ1bmN0aW9uICgkYW5zd2VyKSB7XG4gICAgJGFuc3dlclxuICAgICAgLnJlbW92ZUNsYXNzKCdoNXAtY29ycmVjdCcpXG4gICAgICAucmVtb3ZlQ2xhc3MoJ2g1cC13cm9uZycpXG4gICAgICAucmVtb3ZlQ2xhc3MoJ2g1cC1zaG91bGQnKVxuICAgICAgLnJlbW92ZUNsYXNzKCdoNXAtc2hvdWxkLW5vdCcpXG4gICAgICAucmVtb3ZlQ2xhc3MoJ2g1cC1oYXMtZmVlZGJhY2snKVxuICAgICAgLmZpbmQoJy5oNXAtcXVlc3Rpb24tcGx1cy1vbmUsIC5oNXAtcXVlc3Rpb24tbWludXMtb25lLCAuaDVwLWFuc3dlci1pY29uLCAuaDVwLXNvbHV0aW9uLWljb24sIC5oNXAtZmVlZGJhY2stZGlhbG9nJykucmVtb3ZlKCk7XG4gIH07XG5cbiAgLyoqXG4gICAqXG4gICAqL1xuICB0aGlzLmhpZGVTb2x1dGlvbnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgc29sdXRpb25zVmlzaWJsZSA9IGZhbHNlO1xuXG4gICAgaGlkZVNvbHV0aW9uKCQoJy5oNXAtYW5zd2VyJywgJG15RG9tKSk7XG5cbiAgICB0aGlzLnJlbW92ZUZlZWRiYWNrKCk7IC8vIFJlc2V0IGZlZWRiYWNrXG5cbiAgICBzZWxmLnRyaWdnZXIoJ3Jlc2l6ZScpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBSZXNldHMgdGhlIHdob2xlIHRhc2suXG4gICAqIFVzZWQgaW4gY29udHJhY3RzIHdpdGggaW50ZWdyYXRlZCBjb250ZW50LlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgdGhpcy5yZXNldFRhc2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgc2VsZi5hbnN3ZXJlZCA9IGZhbHNlO1xuICAgIHNlbGYuaGlkZVNvbHV0aW9ucygpO1xuICAgIHBhcmFtcy51c2VyQW5zd2VycyA9IFtdO1xuICAgIHJlbW92ZVNlbGVjdGlvbnMoKTtcbiAgICBzZWxmLnNob3dCdXR0b24oJ2NoZWNrLWFuc3dlcicpO1xuICAgIHNlbGYuaGlkZUJ1dHRvbigndHJ5LWFnYWluJyk7XG4gICAgc2VsZi5oaWRlQnV0dG9uKCdzaG93LXNvbHV0aW9uJyk7XG4gICAgZW5hYmxlSW5wdXQoKTtcbiAgICAkbXlEb20uZmluZCgnLmg1cC1mZWVkYmFjay1hdmFpbGFibGUnKS5yZW1vdmUoKTtcbiAgfTtcblxuICB2YXIgY2FsY3VsYXRlTWF4U2NvcmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKGJsYW5rSXNDb3JyZWN0KSB7XG4gICAgICByZXR1cm4gcGFyYW1zLndlaWdodDtcbiAgICB9XG4gICAgdmFyIG1heFNjb3JlID0gMDtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBhcmFtcy5hbnN3ZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgY2hvaWNlID0gcGFyYW1zLmFuc3dlcnNbaV07XG4gICAgICBpZiAoY2hvaWNlLmNvcnJlY3QpIHtcbiAgICAgICAgbWF4U2NvcmUgKz0gKGNob2ljZS53ZWlnaHQgIT09IHVuZGVmaW5lZCA/IGNob2ljZS53ZWlnaHQgOiAxKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG1heFNjb3JlO1xuICB9O1xuXG4gIHRoaXMuZ2V0TWF4U2NvcmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuICghcGFyYW1zLmJlaGF2aW91ci5zaW5nbGVBbnN3ZXIgJiYgIXBhcmFtcy5iZWhhdmlvdXIuc2luZ2xlUG9pbnQgPyBjYWxjdWxhdGVNYXhTY29yZSgpIDogcGFyYW1zLndlaWdodCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIENoZWNrIGFuc3dlclxuICAgKi9cbiAgdmFyIGNoZWNrQW5zd2VyID0gZnVuY3Rpb24gKCkge1xuICAgIC8vIFVuYmluZCByZW1vdmFsIG9mIGZlZWRiYWNrIGRpYWxvZ3Mgb24gY2xpY2tcbiAgICAkbXlEb20udW5iaW5kKCdjbGljaycsIHJlbW92ZUZlZWRiYWNrRGlhbG9nKTtcblxuICAgIC8vIFJlbW92ZSBhbGwgdGlwIGRpYWxvZ3NcbiAgICByZW1vdmVGZWVkYmFja0RpYWxvZygpO1xuXG4gICAgaWYgKHBhcmFtcy5iZWhhdmlvdXIuZW5hYmxlU29sdXRpb25zQnV0dG9uKSB7XG4gICAgICBzZWxmLnNob3dCdXR0b24oJ3Nob3ctc29sdXRpb24nKTtcbiAgICB9XG4gICAgaWYgKHBhcmFtcy5iZWhhdmlvdXIuZW5hYmxlUmV0cnkpIHtcbiAgICAgIHNlbGYuc2hvd0J1dHRvbigndHJ5LWFnYWluJyk7XG4gICAgfVxuICAgIHNlbGYuaGlkZUJ1dHRvbignY2hlY2stYW5zd2VyJyk7XG5cbiAgICBzZWxmLnNob3dDaGVja1NvbHV0aW9uKCk7XG4gICAgZGlzYWJsZUlucHV0KCk7XG5cbiAgICB2YXIgeEFQSUV2ZW50ID0gc2VsZi5jcmVhdGVYQVBJRXZlbnRUZW1wbGF0ZSgnYW5zd2VyZWQnKTtcbiAgICBhZGRRdWVzdGlvblRvWEFQSSh4QVBJRXZlbnQpO1xuICAgIGFkZFJlc3BvbnNlVG9YQVBJKHhBUElFdmVudCk7XG4gICAgc2VsZi50cmlnZ2VyKHhBUElFdmVudCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIERldGVybWluZSBpZiBhbnkgb2YgdGhlIHJhZGlvcyBvciBjaGVja2JveGVzIGhhdmUgYmVlbiBjaGVja2VkLlxuICAgKlxuICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgKi9cbiAgdmFyIGlzQW5zd2VyU2VsZWN0ZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuICEhJCgnLmg1cC1hbnN3ZXJbYXJpYS1jaGVja2VkPVwidHJ1ZVwiXScsICRteURvbSkubGVuZ3RoO1xuICB9O1xuXG4gIC8qKlxuICAgKiBBZGRzIHRoZSB1aSBidXR0b25zLlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgdmFyIGFkZEJ1dHRvbnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyICRjb250ZW50ID0gJCgnW2RhdGEtY29udGVudC1pZD1cIicgKyBzZWxmLmNvbnRlbnRJZCArICdcIl0uaDVwLWNvbnRlbnQnKTtcbiAgICB2YXIgJGNvbnRhaW5lclBhcmVudHMgPSAkY29udGVudC5wYXJlbnRzKCcuaDVwLWNvbnRhaW5lcicpO1xuXG4gICAgLy8gc2VsZWN0IGZpbmQgY29udGFpbmVyIHRvIGF0dGFjaCBkaWFsb2dzIHRvXG4gICAgdmFyICRjb250YWluZXI7XG4gICAgaWYoJGNvbnRhaW5lclBhcmVudHMubGVuZ3RoICE9PSAwKSB7XG4gICAgICAvLyB1c2UgcGFyZW50IGhpZ2hlc3QgdXAgaWYgYW55XG4gICAgICAkY29udGFpbmVyID0gJGNvbnRhaW5lclBhcmVudHMubGFzdCgpO1xuICAgIH1cbiAgICBlbHNlIGlmKCRjb250ZW50Lmxlbmd0aCAhPT0gMCl7XG4gICAgICAkY29udGFpbmVyID0gJGNvbnRlbnQ7XG4gICAgfVxuICAgIGVsc2UgIHtcbiAgICAgICRjb250YWluZXIgPSAkKGRvY3VtZW50LmJvZHkpO1xuICAgIH1cblxuICAgIC8vIFNob3cgc29sdXRpb24gYnV0dG9uXG4gICAgc2VsZi5hZGRCdXR0b24oJ3Nob3ctc29sdXRpb24nLCBwYXJhbXMuVUkuc2hvd1NvbHV0aW9uQnV0dG9uLCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgIGlmIChwYXJhbXMuYmVoYXZpb3VyLnNob3dTb2x1dGlvbnNSZXF1aXJlc0lucHV0ICYmICFpc0Fuc3dlclNlbGVjdGVkKCkpIHtcbiAgICAgICAgLy8gUmVxdWlyZSBhbnN3ZXIgYmVmb3JlIHNvbHV0aW9uIGNhbiBiZSB2aWV3ZWRcbiAgICAgICAgc2VsZi51cGRhdGVGZWVkYmFja0NvbnRlbnQocGFyYW1zLlVJLm5vSW5wdXQpO1xuICAgICAgICBzZWxmLnJlYWQocGFyYW1zLlVJLm5vSW5wdXQpO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIGNhbGNTY29yZSgpO1xuICAgICAgICBzZWxmLnNob3dBbGxTb2x1dGlvbnMoKTtcbiAgICAgIH1cblxuICAgIH0sIGZhbHNlLCB7XG4gICAgICAnYXJpYS1sYWJlbCc6IHBhcmFtcy5VSS5hMTF5U2hvd1NvbHV0aW9uLFxuICAgIH0pO1xuXG4gICAgLy8gQ2hlY2sgc29sdXRpb24gYnV0dG9uXG4gICAgaWYgKHBhcmFtcy5iZWhhdmlvdXIuZW5hYmxlQ2hlY2tCdXR0b24gJiYgKCFwYXJhbXMuYmVoYXZpb3VyLmF1dG9DaGVjayB8fCAhcGFyYW1zLmJlaGF2aW91ci5zaW5nbGVBbnN3ZXIpKSB7XG4gICAgICBzZWxmLmFkZEJ1dHRvbignY2hlY2stYW5zd2VyJywgcGFyYW1zLlVJLmNoZWNrQW5zd2VyQnV0dG9uLFxuICAgICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgc2VsZi5hbnN3ZXJlZCA9IHRydWU7XG4gICAgICAgICAgY2hlY2tBbnN3ZXIoKTtcbiAgICAgICAgfSxcbiAgICAgICAgdHJ1ZSxcbiAgICAgICAge1xuICAgICAgICAgICdhcmlhLWxhYmVsJzogcGFyYW1zLlVJLmExMXlDaGVjayxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIGNvbmZpcm1hdGlvbkRpYWxvZzoge1xuICAgICAgICAgICAgZW5hYmxlOiBwYXJhbXMuYmVoYXZpb3VyLmNvbmZpcm1DaGVja0RpYWxvZyxcbiAgICAgICAgICAgIGwxMG46IHBhcmFtcy5jb25maXJtQ2hlY2ssXG4gICAgICAgICAgICBpbnN0YW5jZTogc2VsZixcbiAgICAgICAgICAgICRwYXJlbnRFbGVtZW50OiAkY29udGFpbmVyXG4gICAgICAgICAgfSxcbiAgICAgICAgICBjb250ZW50RGF0YTogc2VsZi5jb250ZW50RGF0YSxcbiAgICAgICAgICB0ZXh0SWZTdWJtaXR0aW5nOiBwYXJhbXMuVUkuc3VibWl0QW5zd2VyQnV0dG9uLFxuICAgICAgICB9XG4gICAgICApO1xuICAgIH1cblxuICAgIC8vIFRyeSBBZ2FpbiBidXR0b25cbiAgICBzZWxmLmFkZEJ1dHRvbigndHJ5LWFnYWluJywgcGFyYW1zLlVJLnRyeUFnYWluQnV0dG9uLCBmdW5jdGlvbiAoKSB7XG4gICAgICBzZWxmLnJlc2V0VGFzaygpO1xuXG4gICAgICBpZiAocGFyYW1zLmJlaGF2aW91ci5yYW5kb21BbnN3ZXJzKSB7XG4gICAgICAgIC8vIHJlc2h1ZmZsZSBhbnN3ZXJzXG4gICAgICAgdmFyIG9sZElkTWFwID0gaWRNYXA7XG4gICAgICAgaWRNYXAgPSBnZXRTaHVmZmxlTWFwKCk7XG4gICAgICAgdmFyIGFuc3dlcnNEaXNwbGF5ZWQgPSAkbXlEb20uZmluZCgnLmg1cC1hbnN3ZXInKTtcbiAgICAgICAvLyByZW1lbWJlciB0aXBzXG4gICAgICAgdmFyIHRpcCA9IFtdO1xuICAgICAgIGZvciAoaSA9IDA7IGkgPCBhbnN3ZXJzRGlzcGxheWVkLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICB0aXBbaV0gPSAkKGFuc3dlcnNEaXNwbGF5ZWRbaV0pLmZpbmQoJy5oNXAtTXVsdGlDaG9pY2VTY29yZTRMTVMtdGlwd3JhcCcpO1xuICAgICAgIH1cbiAgICAgICAvLyBUaG9zZSB0d28gbG9vcHMgY2Fubm90IGJlIG1lcmdlZCBvciB5b3UnbGwgc2NyZXcgdXAgeW91ciB0aXBzXG4gICAgICAgZm9yIChpID0gMDsgaSA8IGFuc3dlcnNEaXNwbGF5ZWQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgIC8vIG1vdmUgdGlwcyBhbmQgYW5zd2VycyBvbiBkaXNwbGF5XG4gICAgICAgICAkKGFuc3dlcnNEaXNwbGF5ZWRbaV0pLmZpbmQoJy5oNXAtYWx0ZXJuYXRpdmUtaW5uZXInKS5odG1sKHBhcmFtcy5hbnN3ZXJzW2ldLnRleHQpO1xuICAgICAgICAgJCh0aXBbaV0pLmRldGFjaCgpLmFwcGVuZFRvKCQoYW5zd2Vyc0Rpc3BsYXllZFtpZE1hcC5pbmRleE9mKG9sZElkTWFwW2ldKV0pLmZpbmQoJy5oNXAtYWx0ZXJuYXRpdmUtY29udGFpbmVyJykpO1xuICAgICAgIH1cbiAgICAgfVxuICAgIH0sIGZhbHNlLCB7XG4gICAgICAnYXJpYS1sYWJlbCc6IHBhcmFtcy5VSS5hMTF5UmV0cnksXG4gICAgfSwge1xuICAgICAgY29uZmlybWF0aW9uRGlhbG9nOiB7XG4gICAgICAgIGVuYWJsZTogcGFyYW1zLmJlaGF2aW91ci5jb25maXJtUmV0cnlEaWFsb2csXG4gICAgICAgIGwxMG46IHBhcmFtcy5jb25maXJtUmV0cnksXG4gICAgICAgIGluc3RhbmNlOiBzZWxmLFxuICAgICAgICAkcGFyZW50RWxlbWVudDogJGNvbnRhaW5lclxuICAgICAgfVxuICAgIH0pO1xuICB9O1xuXG4gIC8qKlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgdmFyIGluc2VydEZlZWRiYWNrID0gZnVuY3Rpb24gKCRlLCBmZWVkYmFjaykge1xuICAgIC8vIEFkZCB2aXN1YWxzXG4gICAgYWRkRmVlZGJhY2soJGUsIGZlZWRiYWNrKTtcblxuICAgIC8vIEFkZCBidXR0b24gZm9yIHJlYWRzcGVha2Vyc1xuICAgIHZhciAkd3JhcCA9ICQoJzxkaXYvPicsIHtcbiAgICAgICdjbGFzcyc6ICdoNXAtaGlkZGVuLXJlYWQgaDVwLWZlZWRiYWNrLWF2YWlsYWJsZScsXG4gICAgICAnYXJpYS1sYWJlbCc6IHBhcmFtcy5VSS5mZWVkYmFja0F2YWlsYWJsZSArICcuJ1xuICAgIH0pO1xuICAgICQoJzxkaXYvPicsIHtcbiAgICAgICdyb2xlJzogJ2J1dHRvbicsXG4gICAgICAndGFiaW5kZXgnOiAwLFxuICAgICAgJ2FyaWEtbGFiZWwnOiBwYXJhbXMuVUkucmVhZEZlZWRiYWNrICsgJy4nLFxuICAgICAgYXBwZW5kVG86ICR3cmFwLFxuICAgICAgb246IHtcbiAgICAgICAga2V5ZG93bjogZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICBpZiAoZS53aGljaCA9PT0gMzIpIHsgLy8gU3BhY2VcbiAgICAgICAgICAgIHNlbGYucmVhZChmZWVkYmFjayk7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gICAgJHdyYXAuYXBwZW5kVG8oJGUpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBEZXRlcm1pbmUgd2hpY2ggZmVlZGJhY2sgdGV4dCB0byBkaXNwbGF5XG4gICAqXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBzY29yZVxuICAgKiBAcGFyYW0ge251bWJlcn0gbWF4XG4gICAqIEByZXR1cm4ge3N0cmluZ31cbiAgICovXG4gIHZhciBnZXRGZWVkYmFja1RleHQgPSBmdW5jdGlvbiAoc2NvcmUsIG1heCkge1xuICAgIHZhciByYXRpbyA9IChzY29yZSAvIG1heCk7XG5cbiAgICB2YXIgZmVlZGJhY2sgPSBINVAuUXVlc3Rpb24uZGV0ZXJtaW5lT3ZlcmFsbEZlZWRiYWNrKHBhcmFtcy5vdmVyYWxsRmVlZGJhY2ssIHJhdGlvKTtcblxuICAgIHJldHVybiBmZWVkYmFjay5yZXBsYWNlKCdAc2NvcmUnLCBzY29yZSkucmVwbGFjZSgnQHRvdGFsJywgbWF4KTtcbiAgfTtcblxuICAvKipcbiAgICogU2hvd3MgZmVlZGJhY2sgb24gdGhlIHNlbGVjdGVkIGZpZWxkcy5cbiAgICogQHB1YmxpY1xuICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtza2lwRmVlZGJhY2tdIFNraXAgc2hvd2luZyBmZWVkYmFjayBpZiB0cnVlXG4gICAqL1xuICB0aGlzLnNob3dDaGVja1NvbHV0aW9uID0gZnVuY3Rpb24gKHNraXBGZWVkYmFjaykge1xuICAgIHZhciBzY29yZVBvaW50cztcbiAgICBpZiAoIShwYXJhbXMuYmVoYXZpb3VyLnNpbmdsZUFuc3dlciB8fCBwYXJhbXMuYmVoYXZpb3VyLnNpbmdsZVBvaW50IHx8ICFwYXJhbXMuYmVoYXZpb3VyLnNob3dTY29yZVBvaW50cykpIHtcbiAgICAgIHNjb3JlUG9pbnRzID0gbmV3IEg1UC5RdWVzdGlvbi5TY29yZVBvaW50cygpO1xuICAgIH1cblxuICAgICRteURvbS5maW5kKCcuaDVwLWFuc3dlcicpLmVhY2goZnVuY3Rpb24gKGksIGUpIHtcbiAgICAgIHZhciAkZSA9ICQoZSk7XG4gICAgICB2YXIgYSA9IHBhcmFtcy5hbnN3ZXJzW2ldO1xuICAgICAgdmFyIGNob3NlbiA9ICgkZS5hdHRyKCdhcmlhLWNoZWNrZWQnKSA9PT0gJ3RydWUnKTtcbiAgICAgIGlmIChjaG9zZW4pIHtcbiAgICAgICAgaWYgKGEuY29ycmVjdCkge1xuICAgICAgICAgIC8vIE1heSBhbHJlYWR5IGhhdmUgYmVlbiBhcHBsaWVkIGJ5IGluc3RhbnQgZmVlZGJhY2tcbiAgICAgICAgICBpZiAoISRlLmhhc0NsYXNzKCdoNXAtY29ycmVjdCcpKSB7XG4gICAgICAgICAgICAkZS5hZGRDbGFzcygnaDVwLWNvcnJlY3QnKS5hcHBlbmQoJCgnPHNwYW4vPicsIHtcbiAgICAgICAgICAgICAgJ2NsYXNzJzogJ2g1cC1hbnN3ZXItaWNvbicsXG4gICAgICAgICAgICAgIGh0bWw6IHBhcmFtcy5VSS5jb3JyZWN0QW5zd2VyICsgJy4nXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIGlmICghJGUuaGFzQ2xhc3MoJ2g1cC13cm9uZycpKSB7XG4gICAgICAgICAgICAkZS5hZGRDbGFzcygnaDVwLXdyb25nJykuYXBwZW5kKCQoJzxzcGFuLz4nLCB7XG4gICAgICAgICAgICAgICdjbGFzcyc6ICdoNXAtYW5zd2VyLWljb24nLFxuICAgICAgICAgICAgICBodG1sOiBwYXJhbXMuVUkud3JvbmdBbnN3ZXIgKyAnLidcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoc2NvcmVQb2ludHMpIHtcbiAgICAgICAgICB2YXIgYWx0ZXJuYXRpdmVDb250YWluZXIgPSAkZVswXS5xdWVyeVNlbGVjdG9yKCcuaDVwLWFsdGVybmF0aXZlLWNvbnRhaW5lcicpO1xuXG4gICAgICAgICAgaWYgKCFwYXJhbXMuYmVoYXZpb3VyLmF1dG9DaGVjayB8fCBhbHRlcm5hdGl2ZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuaDVwLXF1ZXN0aW9uLXBsdXMtb25lLCAuaDVwLXF1ZXN0aW9uLW1pbnVzLW9uZScpID09PSBudWxsKSB7XG4gICAgICAgICAgICBhbHRlcm5hdGl2ZUNvbnRhaW5lci5hcHBlbmRDaGlsZChzY29yZVBvaW50cy5nZXRFbGVtZW50KGEuY29ycmVjdCkpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoIXNraXBGZWVkYmFjaykge1xuICAgICAgICBpZiAoY2hvc2VuICYmIGEudGlwc0FuZEZlZWRiYWNrLmNob3NlbkZlZWRiYWNrICE9PSB1bmRlZmluZWQgJiYgYS50aXBzQW5kRmVlZGJhY2suY2hvc2VuRmVlZGJhY2sgIT09ICcnKSB7XG4gICAgICAgICAgaW5zZXJ0RmVlZGJhY2soJGUsIGEudGlwc0FuZEZlZWRiYWNrLmNob3NlbkZlZWRiYWNrKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICghY2hvc2VuICYmIGEudGlwc0FuZEZlZWRiYWNrLm5vdENob3NlbkZlZWRiYWNrICE9PSB1bmRlZmluZWQgJiYgYS50aXBzQW5kRmVlZGJhY2subm90Q2hvc2VuRmVlZGJhY2sgIT09ICcnKSB7XG4gICAgICAgICAgaW5zZXJ0RmVlZGJhY2soJGUsIGEudGlwc0FuZEZlZWRiYWNrLm5vdENob3NlbkZlZWRiYWNrKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gRGV0ZXJtaW5lIGZlZWRiYWNrXG4gICAgdmFyIG1heCA9IHNlbGYuZ2V0TWF4U2NvcmUoKTtcblxuICAgIC8vIERpc2FibGUgdGFzayBpZiBtYXhzY29yZSBpcyBhY2hpZXZlZFxuICAgIHZhciBmdWxsU2NvcmUgPSAoc2NvcmUgPT09IG1heCk7XG5cbiAgICBpZiAoZnVsbFNjb3JlKSB7XG4gICAgICBzZWxmLmhpZGVCdXR0b24oJ2NoZWNrLWFuc3dlcicpO1xuICAgICAgc2VsZi5oaWRlQnV0dG9uKCd0cnktYWdhaW4nKTtcbiAgICAgIHNlbGYuaGlkZUJ1dHRvbignc2hvdy1zb2x1dGlvbicpO1xuICAgIH1cblxuICAgIC8vIFNob3cgZmVlZGJhY2tcbiAgICBpZiAoIXNraXBGZWVkYmFjaykge1xuICAgICAgdGhpcy5zZXRGZWVkYmFjayhnZXRGZWVkYmFja1RleHQoc2NvcmUsIG1heCksIHNjb3JlLCBtYXgsIHBhcmFtcy5VSS5zY29yZUJhckxhYmVsKTtcbiAgICB9XG5cbiAgICBzZWxmLnRyaWdnZXIoJ3Jlc2l6ZScpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBEaXNhYmxlcyBjaG9vc2luZyBuZXcgaW5wdXQuXG4gICAqL1xuICB2YXIgZGlzYWJsZUlucHV0ID0gZnVuY3Rpb24gKCkge1xuICAgICQoJy5oNXAtYW5zd2VyJywgJG15RG9tKS5hdHRyKHtcbiAgICAgICdhcmlhLWRpc2FibGVkJzogJ3RydWUnLFxuICAgICAgJ3RhYmluZGV4JzogJy0xJ1xuICAgIH0pO1xuICB9O1xuXG4gIC8qKlxuICAgKiBFbmFibGVzIG5ldyBpbnB1dC5cbiAgICovXG4gIHZhciBlbmFibGVJbnB1dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAkKCcuaDVwLWFuc3dlcicsICRteURvbSkuYXR0cignYXJpYS1kaXNhYmxlZCcsICdmYWxzZScpO1xuICB9O1xuXG4gIHZhciBjYWxjU2NvcmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgc2NvcmUgPSAwO1xuICAgIGZvciAoY29uc3QgYW5zd2VyIG9mIHBhcmFtcy51c2VyQW5zd2Vycykge1xuICAgICAgY29uc3QgY2hvaWNlID0gcGFyYW1zLmFuc3dlcnNbYW5zd2VyXTtcbiAgICAgIGNvbnN0IHdlaWdodCA9IChjaG9pY2Uud2VpZ2h0ICE9PSB1bmRlZmluZWQgPyBjaG9pY2Uud2VpZ2h0IDogMSk7XG4gICAgICBpZiAoY2hvaWNlLmNvcnJlY3QpIHtcbiAgICAgICAgc2NvcmUgKz0gd2VpZ2h0O1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIHNjb3JlIC09IHdlaWdodDtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKHNjb3JlIDwgMCkge1xuICAgICAgc2NvcmUgPSAwO1xuICAgIH1cbiAgICBpZiAoIXBhcmFtcy51c2VyQW5zd2Vycy5sZW5ndGggJiYgYmxhbmtJc0NvcnJlY3QpIHtcbiAgICAgIHNjb3JlID0gcGFyYW1zLndlaWdodDtcbiAgICB9XG4gICAgaWYgKHBhcmFtcy5iZWhhdmlvdXIuc2luZ2xlUG9pbnQpIHtcbiAgICAgIHNjb3JlID0gKDEwMCAqIHNjb3JlIC8gY2FsY3VsYXRlTWF4U2NvcmUoKSkgPj0gcGFyYW1zLmJlaGF2aW91ci5wYXNzUGVyY2VudGFnZSA/IHBhcmFtcy53ZWlnaHQgOiAwO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogUmVtb3ZlcyBzZWxlY3Rpb25zIGZyb20gdGFzay5cbiAgICovXG4gIHZhciByZW1vdmVTZWxlY3Rpb25zID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciAkYW5zd2VycyA9ICQoJy5oNXAtYW5zd2VyJywgJG15RG9tKVxuICAgICAgLnJlbW92ZUNsYXNzKCdoNXAtc2VsZWN0ZWQnKVxuICAgICAgLmF0dHIoJ2FyaWEtY2hlY2tlZCcsICdmYWxzZScpO1xuXG4gICAgaWYgKCFwYXJhbXMuYmVoYXZpb3VyLnNpbmdsZUFuc3dlcikge1xuICAgICAgJGFuc3dlcnMuYXR0cigndGFiaW5kZXgnLCAnMCcpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICRhbnN3ZXJzLmZpcnN0KCkuYXR0cigndGFiaW5kZXgnLCAnMCcpO1xuICAgIH1cblxuICAgIC8vIFNldCBmb2N1cyB0byBmaXJzdCBvcHRpb25cbiAgICAkYW5zd2Vycy5maXJzdCgpLmZvY3VzKCk7XG5cbiAgICBjYWxjU2NvcmUoKTtcbiAgfTtcblxuICAvKipcbiAgICogR2V0IHhBUEkgZGF0YS5cbiAgICogQ29udHJhY3QgdXNlZCBieSByZXBvcnQgcmVuZGVyaW5nIGVuZ2luZS5cbiAgICpcbiAgICogQHNlZSBjb250cmFjdCBhdCB7QGxpbmsgaHR0cHM6Ly9oNXAub3JnL2RvY3VtZW50YXRpb24vZGV2ZWxvcGVycy9jb250cmFjdHMjZ3VpZGVzLWhlYWRlci02fVxuICAgKi9cbiAgdGhpcy5nZXRYQVBJRGF0YSA9IGZ1bmN0aW9uKCl7XG4gICAgdmFyIHhBUElFdmVudCA9IHRoaXMuY3JlYXRlWEFQSUV2ZW50VGVtcGxhdGUoJ2Fuc3dlcmVkJyk7XG4gICAgYWRkUXVlc3Rpb25Ub1hBUEkoeEFQSUV2ZW50KTtcbiAgICBhZGRSZXNwb25zZVRvWEFQSSh4QVBJRXZlbnQpO1xuICAgIHJldHVybiB7XG4gICAgICBzdGF0ZW1lbnQ6IHhBUElFdmVudC5kYXRhLnN0YXRlbWVudFxuICAgIH07XG4gIH07XG5cbiAgLyoqXG4gICAqIEFkZCB0aGUgcXVlc3Rpb24gaXRzZWxmIHRvIHRoZSBkZWZpbml0aW9uIHBhcnQgb2YgYW4geEFQSUV2ZW50XG4gICAqL1xuICB2YXIgYWRkUXVlc3Rpb25Ub1hBUEkgPSBmdW5jdGlvbiAoeEFQSUV2ZW50KSB7XG4gICAgdmFyIGRlZmluaXRpb24gPSB4QVBJRXZlbnQuZ2V0VmVyaWZpZWRTdGF0ZW1lbnRWYWx1ZShbJ29iamVjdCcsICdkZWZpbml0aW9uJ10pO1xuICAgIGRlZmluaXRpb24uZGVzY3JpcHRpb24gPSB7XG4gICAgICAvLyBSZW1vdmUgdGFncywgbXVzdCB3cmFwIGluIGRpdiB0YWcgYmVjYXVzZSBqUXVlcnkgMS45IHdpbGwgY3Jhc2ggaWYgdGhlIHN0cmluZyBpc24ndCB3cmFwcGVkIGluIGEgdGFnLlxuICAgICAgJ2VuLVVTJzogJCgnPGRpdj4nICsgcGFyYW1zLnF1ZXN0aW9uICsgJzwvZGl2PicpLnRleHQoKVxuICAgIH07XG4gICAgZGVmaW5pdGlvbi50eXBlID0gJ2h0dHA6Ly9hZGxuZXQuZ292L2V4cGFwaS9hY3Rpdml0aWVzL2NtaS5pbnRlcmFjdGlvbic7XG4gICAgZGVmaW5pdGlvbi5pbnRlcmFjdGlvblR5cGUgPSAnY2hvaWNlJztcbiAgICBkZWZpbml0aW9uLmNvcnJlY3RSZXNwb25zZXNQYXR0ZXJuID0gW107XG4gICAgZGVmaW5pdGlvbi5jaG9pY2VzID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwYXJhbXMuYW5zd2Vycy5sZW5ndGg7IGkrKykge1xuICAgICAgZGVmaW5pdGlvbi5jaG9pY2VzW2ldID0ge1xuICAgICAgICAnaWQnOiBwYXJhbXMuYW5zd2Vyc1tpXS5vcmlnaW5hbE9yZGVyICsgJycsXG4gICAgICAgICdkZXNjcmlwdGlvbic6IHtcbiAgICAgICAgICAvLyBSZW1vdmUgdGFncywgbXVzdCB3cmFwIGluIGRpdiB0YWcgYmVjYXVzZSBqUXVlcnkgMS45IHdpbGwgY3Jhc2ggaWYgdGhlIHN0cmluZyBpc24ndCB3cmFwcGVkIGluIGEgdGFnLlxuICAgICAgICAgICdlbi1VUyc6ICQoJzxkaXY+JyArIHBhcmFtcy5hbnN3ZXJzW2ldLnRleHQgKyAnPC9kaXY+JykudGV4dCgpXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBpZiAocGFyYW1zLmFuc3dlcnNbaV0uY29ycmVjdCkge1xuICAgICAgICBpZiAoIXBhcmFtcy5zaW5nbGVBbnN3ZXIpIHtcbiAgICAgICAgICBpZiAoZGVmaW5pdGlvbi5jb3JyZWN0UmVzcG9uc2VzUGF0dGVybi5sZW5ndGgpIHtcbiAgICAgICAgICAgIGRlZmluaXRpb24uY29ycmVjdFJlc3BvbnNlc1BhdHRlcm5bMF0gKz0gJ1ssXSc7XG4gICAgICAgICAgICAvLyBUaGlzIGxvb2tzIGluc2FuZSwgYnV0IGl0J3MgaG93IHlvdSBzZXBhcmF0ZSBtdWx0aXBsZSBhbnN3ZXJzXG4gICAgICAgICAgICAvLyB0aGF0IG11c3QgYWxsIGJlIGNob3NlbiB0byBhY2hpZXZlIHBlcmZlY3Qgc2NvcmUuLi5cbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBkZWZpbml0aW9uLmNvcnJlY3RSZXNwb25zZXNQYXR0ZXJuLnB1c2goJycpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBkZWZpbml0aW9uLmNvcnJlY3RSZXNwb25zZXNQYXR0ZXJuWzBdICs9IHBhcmFtcy5hbnN3ZXJzW2ldLm9yaWdpbmFsT3JkZXI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgZGVmaW5pdGlvbi5jb3JyZWN0UmVzcG9uc2VzUGF0dGVybi5wdXNoKCcnICsgcGFyYW1zLmFuc3dlcnNbaV0ub3JpZ2luYWxPcmRlcik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIEFkZCB0aGUgcmVzcG9uc2UgcGFydCB0byBhbiB4QVBJIGV2ZW50XG4gICAqXG4gICAqIEBwYXJhbSB7SDVQLlhBUElFdmVudH0geEFQSUV2ZW50XG4gICAqICBUaGUgeEFQSSBldmVudCB3ZSB3aWxsIGFkZCBhIHJlc3BvbnNlIHRvXG4gICAqL1xuICB2YXIgYWRkUmVzcG9uc2VUb1hBUEkgPSBmdW5jdGlvbiAoeEFQSUV2ZW50KSB7XG4gICAgdmFyIG1heFNjb3JlID0gc2VsZi5nZXRNYXhTY29yZSgpO1xuICAgIHZhciBzdWNjZXNzID0gKDEwMCAqIHNjb3JlIC8gbWF4U2NvcmUpID49IHBhcmFtcy5iZWhhdmlvdXIucGFzc1BlcmNlbnRhZ2U7XG5cbiAgICB4QVBJRXZlbnQuc2V0U2NvcmVkUmVzdWx0KHNjb3JlLCBtYXhTY29yZSwgc2VsZiwgdHJ1ZSwgc3VjY2Vzcyk7XG4gICAgaWYgKHBhcmFtcy51c2VyQW5zd2VycyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBjYWxjU2NvcmUoKTtcbiAgICB9XG5cbiAgICAvLyBBZGQgdGhlIHJlc3BvbnNlXG4gICAgdmFyIHJlc3BvbnNlID0gJyc7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwYXJhbXMudXNlckFuc3dlcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChyZXNwb25zZSAhPT0gJycpIHtcbiAgICAgICAgcmVzcG9uc2UgKz0gJ1ssXSc7XG4gICAgICB9XG4gICAgICByZXNwb25zZSArPSBpZE1hcCA9PT0gdW5kZWZpbmVkID8gcGFyYW1zLnVzZXJBbnN3ZXJzW2ldIDogaWRNYXBbcGFyYW1zLnVzZXJBbnN3ZXJzW2ldXTtcbiAgICB9XG4gICAgeEFQSUV2ZW50LmRhdGEuc3RhdGVtZW50LnJlc3VsdC5yZXNwb25zZSA9IHJlc3BvbnNlO1xuICB9O1xuXG4gIC8qKlxuICAgKiBDcmVhdGUgYSBtYXAgcG9pbnRpbmcgZnJvbSBvcmlnaW5hbCBhbnN3ZXJzIHRvIHNodWZmbGVkIGFuc3dlcnNcbiAgICpcbiAgICogQHJldHVybiB7bnVtYmVyW119IG1hcCBwb2ludGluZyBmcm9tIG9yaWdpbmFsIGFuc3dlcnMgdG8gc2h1ZmZsZWQgYW5zd2Vyc1xuICAgKi9cbiAgdmFyIGdldFNodWZmbGVNYXAgPSBmdW5jdGlvbigpIHtcbiAgICBwYXJhbXMuYW5zd2VycyA9IEg1UC5zaHVmZmxlQXJyYXkocGFyYW1zLmFuc3dlcnMpO1xuXG4gICAgLy8gQ3JlYXRlIGEgbWFwIGZyb20gdGhlIG5ldyBpZCB0byB0aGUgb2xkIG9uZVxuICAgIHZhciBpZE1hcCA9IFtdO1xuICAgIGZvciAoaSA9IDA7IGkgPCBwYXJhbXMuYW5zd2Vycy5sZW5ndGg7IGkrKykge1xuICAgICAgaWRNYXBbaV0gPSBwYXJhbXMuYW5zd2Vyc1tpXS5vcmlnaW5hbE9yZGVyO1xuICAgIH1cbiAgICByZXR1cm4gaWRNYXA7XG4gIH07XG5cbiAgLy8gSW5pdGlhbGl6YXRpb24gY29kZVxuICAvLyBSYW5kb21pemUgb3JkZXIsIGlmIHJlcXVlc3RlZFxuICB2YXIgaWRNYXA7XG4gIC8vIFN0b3JlIG9yaWdpbmFsIG9yZGVyIGluIGFuc3dlcnNcbiAgZm9yIChpID0gMDsgaSA8IHBhcmFtcy5hbnN3ZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgcGFyYW1zLmFuc3dlcnNbaV0ub3JpZ2luYWxPcmRlciA9IGk7XG4gIH1cbiAgaWYgKHBhcmFtcy5iZWhhdmlvdXIucmFuZG9tQW5zd2Vycykge1xuICAgIGlkTWFwID0gZ2V0U2h1ZmZsZU1hcCgpO1xuICB9XG5cbiAgLy8gU3RhcnQgd2l0aCBhbiBlbXB0eSBzZXQgb2YgdXNlciBhbnN3ZXJzLlxuICBwYXJhbXMudXNlckFuc3dlcnMgPSBbXTtcblxuICAvLyBSZXN0b3JlIHByZXZpb3VzIHN0YXRlXG4gIGlmIChjb250ZW50RGF0YSAmJiBjb250ZW50RGF0YS5wcmV2aW91c1N0YXRlICE9PSB1bmRlZmluZWQpIHtcblxuICAgIC8vIFJlc3RvcmUgYW5zd2Vyc1xuICAgIGlmIChjb250ZW50RGF0YS5wcmV2aW91c1N0YXRlLmFuc3dlcnMpIHtcbiAgICAgIGlmICghaWRNYXApIHtcbiAgICAgICAgcGFyYW1zLnVzZXJBbnN3ZXJzID0gY29udGVudERhdGEucHJldmlvdXNTdGF0ZS5hbnN3ZXJzO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIC8vIFRoZSBhbnN3ZXJzIGhhdmUgYmVlbiBzaHVmZmxlZCwgYW5kIHdlIG11c3QgdXNlIHRoZSBpZCBtYXBwaW5nLlxuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgY29udGVudERhdGEucHJldmlvdXNTdGF0ZS5hbnN3ZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBpZE1hcC5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgaWYgKGlkTWFwW2tdID09PSBjb250ZW50RGF0YS5wcmV2aW91c1N0YXRlLmFuc3dlcnNbaV0pIHtcbiAgICAgICAgICAgICAgcGFyYW1zLnVzZXJBbnN3ZXJzLnB1c2goayk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBjYWxjU2NvcmUoKTtcbiAgICB9XG4gIH1cblxuICB2YXIgaGFzQ2hlY2tlZEFuc3dlciA9IGZhbHNlO1xuXG4gIC8vIExvb3AgdGhyb3VnaCBjaG9pY2VzXG4gIGZvciAodmFyIGogPSAwOyBqIDwgcGFyYW1zLmFuc3dlcnMubGVuZ3RoOyBqKyspIHtcbiAgICB2YXIgYW5zID0gcGFyYW1zLmFuc3dlcnNbal07XG5cbiAgICBpZiAoIXBhcmFtcy5iZWhhdmlvdXIuc2luZ2xlQW5zd2VyKSB7XG4gICAgICAvLyBTZXQgcm9sZVxuICAgICAgYW5zLnJvbGUgPSAnY2hlY2tib3gnO1xuICAgICAgYW5zLnRhYmluZGV4ID0gJzAnO1xuICAgICAgaWYgKHBhcmFtcy51c2VyQW5zd2Vycy5pbmRleE9mKGopICE9PSAtMSkge1xuICAgICAgICBhbnMuY2hlY2tlZCA9ICd0cnVlJztcbiAgICAgICAgaGFzQ2hlY2tlZEFuc3dlciA9IHRydWU7XG4gICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgLy8gU2V0IHJvbGVcbiAgICAgIGFucy5yb2xlID0gJ3JhZGlvJztcblxuICAgICAgLy8gRGV0ZXJtaW5lIHRhYmluZGV4LCBjaGVja2VkIGFuZCBleHRyYSBjbGFzc2VzXG4gICAgICBpZiAocGFyYW1zLnVzZXJBbnN3ZXJzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAvLyBObyBjb3JyZWN0IGFuc3dlcnNcbiAgICAgICAgaWYgKGkgPT09IDAgfHwgaSA9PT0gcGFyYW1zLmFuc3dlcnMubGVuZ3RoKSB7XG4gICAgICAgICAgYW5zLnRhYmluZGV4ID0gJzAnO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBlbHNlIGlmIChwYXJhbXMudXNlckFuc3dlcnMuaW5kZXhPZihqKSAhPT0gLTEpIHtcbiAgICAgICAgLy8gVGhpcyBpcyB0aGUgY29ycmVjdCBjaG9pY2VcbiAgICAgICAgYW5zLnRhYmluZGV4ID0gJzAnO1xuICAgICAgICBhbnMuY2hlY2tlZCA9ICd0cnVlJztcbiAgICAgICAgaGFzQ2hlY2tlZEFuc3dlciA9IHRydWU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gU2V0IGRlZmF1bHRcbiAgICBpZiAoYW5zLnRhYmluZGV4ID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGFucy50YWJpbmRleCA9ICctMSc7XG4gICAgfVxuICAgIGlmIChhbnMuY2hlY2tlZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBhbnMuY2hlY2tlZCA9ICdmYWxzZSc7XG4gICAgfVxuICB9XG5cbiAgSDVQLk11bHRpQ2hvaWNlU2NvcmU0TE1TLmNvdW50ZXIgPSAoSDVQLk11bHRpQ2hvaWNlU2NvcmU0TE1TLmNvdW50ZXIgPT09IHVuZGVmaW5lZCA/IDAgOiBINVAuTXVsdGlDaG9pY2VTY29yZTRMTVMuY291bnRlciArIDEpO1xuICBwYXJhbXMucm9sZSA9IChwYXJhbXMuYmVoYXZpb3VyLnNpbmdsZUFuc3dlciA/ICdyYWRpb2dyb3VwJyA6ICdncm91cCcpO1xuICBwYXJhbXMubGFiZWwgPSAnaDVwLW1jcScgKyBINVAuTXVsdGlDaG9pY2VTY29yZTRMTVMuY291bnRlcjtcblxuICAvKipcbiAgICogUGFjayB0aGUgY3VycmVudCBzdGF0ZSBvZiB0aGUgaW50ZXJhY3Rpdml0eSBpbnRvIGEgb2JqZWN0IHRoYXQgY2FuIGJlXG4gICAqIHNlcmlhbGl6ZWQuXG4gICAqXG4gICAqIEBwdWJsaWNcbiAgICovXG4gIHRoaXMuZ2V0Q3VycmVudFN0YXRlID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBzdGF0ZSA9IHt9O1xuICAgIGlmICghaWRNYXApIHtcbiAgICAgIHN0YXRlLmFuc3dlcnMgPSBwYXJhbXMudXNlckFuc3dlcnM7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgLy8gVGhlIGFuc3dlcnMgaGF2ZSBiZWVuIHNodWZmbGVkIGFuZCBtdXN0IGJlIG1hcHBlZCBiYWNrIHRvIHRoZWlyXG4gICAgICAvLyBvcmlnaW5hbCBJRC5cbiAgICAgIHN0YXRlLmFuc3dlcnMgPSBbXTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGFyYW1zLnVzZXJBbnN3ZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHN0YXRlLmFuc3dlcnMucHVzaChpZE1hcFtwYXJhbXMudXNlckFuc3dlcnNbaV1dKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHN0YXRlO1xuICB9O1xuXG4gIC8qKlxuICAgKiBDaGVjayBpZiB1c2VyIGhhcyBnaXZlbiBhbiBhbnN3ZXIuXG4gICAqXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2lnbm9yZUNoZWNrXSBJZ25vcmUgcmV0dXJuaW5nIHRydWUgZnJvbSBwcmVzc2luZyBcImNoZWNrLWFuc3dlclwiIGJ1dHRvbi5cbiAgICogQHJldHVybiB7Ym9vbGVhbn0gVHJ1ZSBpZiBhbnN3ZXIgaXMgZ2l2ZW5cbiAgICovXG4gIHRoaXMuZ2V0QW5zd2VyR2l2ZW4gPSBmdW5jdGlvbiAoaWdub3JlQ2hlY2spIHtcbiAgICB2YXIgYW5zd2VyZWQgPSBpZ25vcmVDaGVjayA/IGZhbHNlIDogdGhpcy5hbnN3ZXJlZDtcbiAgICByZXR1cm4gYW5zd2VyZWQgfHwgcGFyYW1zLnVzZXJBbnN3ZXJzLmxlbmd0aCA+IDAgfHwgYmxhbmtJc0NvcnJlY3Q7XG4gIH07XG5cbiAgdGhpcy5nZXRTY29yZSA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gc2NvcmU7XG4gIH07XG5cbiAgdGhpcy5nZXRUaXRsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gSDVQLmNyZWF0ZVRpdGxlKCh0aGlzLmNvbnRlbnREYXRhICYmIHRoaXMuY29udGVudERhdGEubWV0YWRhdGEgJiYgdGhpcy5jb250ZW50RGF0YS5tZXRhZGF0YS50aXRsZSkgPyB0aGlzLmNvbnRlbnREYXRhLm1ldGFkYXRhLnRpdGxlIDogJ011bHRpcGxlIENob2ljZScpO1xuICB9O1xufTtcblxuSDVQLk11bHRpQ2hvaWNlU2NvcmU0TE1TLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoSDVQLlF1ZXN0aW9uLnByb3RvdHlwZSk7XG5INVAuTXVsdGlDaG9pY2VTY29yZTRMTVMucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gSDVQLk11bHRpQ2hvaWNlU2NvcmU0TE1TO1xuIl0sIm5hbWVzIjpbIkg1UCIsIk11bHRpQ2hvaWNlU2NvcmU0TE1TIiwib3B0aW9ucyIsImNvbnRlbnRJZCIsImNvbnRlbnREYXRhIiwidGhpcyIsInNlbGYiLCJRdWVzdGlvbiIsImNhbGwiLCIkIiwialF1ZXJ5IiwidGVtcGxhdGUiLCJFSlMiLCJ0ZXh0IiwicGFyYW1zIiwiZXh0ZW5kIiwiaW1hZ2UiLCJxdWVzdGlvbiIsImFuc3dlcnMiLCJ0aXBzQW5kRmVlZGJhY2siLCJ0aXAiLCJjaG9zZW5GZWVkYmFjayIsIm5vdENob3NlbkZlZWRiYWNrIiwiY29ycmVjdCIsIm92ZXJhbGxGZWVkYmFjayIsIndlaWdodCIsInVzZXJBbnN3ZXJzIiwiVUkiLCJjaGVja0Fuc3dlckJ1dHRvbiIsInN1Ym1pdEFuc3dlckJ1dHRvbiIsInNob3dTb2x1dGlvbkJ1dHRvbiIsInRyeUFnYWluQnV0dG9uIiwic2NvcmVCYXJMYWJlbCIsInRpcEF2YWlsYWJsZSIsImZlZWRiYWNrQXZhaWxhYmxlIiwicmVhZEZlZWRiYWNrIiwic2hvdWxkQ2hlY2siLCJzaG91bGROb3RDaGVjayIsIm5vSW5wdXQiLCJhMTF5Q2hlY2siLCJhMTF5U2hvd1NvbHV0aW9uIiwiYTExeVJldHJ5IiwiYmVoYXZpb3VyIiwiZW5hYmxlUmV0cnkiLCJlbmFibGVTb2x1dGlvbnNCdXR0b24iLCJlbmFibGVDaGVja0J1dHRvbiIsInR5cGUiLCJzaW5nbGVQb2ludCIsInJhbmRvbUFuc3dlcnMiLCJzaG93U29sdXRpb25zUmVxdWlyZXNJbnB1dCIsImF1dG9DaGVjayIsInBhc3NQZXJjZW50YWdlIiwic2hvd1Njb3JlUG9pbnRzIiwibnVtQ29ycmVjdCIsImkiLCJsZW5ndGgiLCJhbnN3ZXIiLCJibGFua0lzQ29ycmVjdCIsInNpbmdsZUFuc3dlciIsIiRteURvbSIsIiRmZWVkYmFja0RpYWxvZyIsInJlbW92ZUZlZWRiYWNrRGlhbG9nIiwidW5iaW5kIiwiZmluZCIsInJlbW92ZSIsInJlbW92ZUNsYXNzIiwic2NvcmUiLCJzb2x1dGlvbnNWaXNpYmxlIiwiYWRkRmVlZGJhY2siLCIkZWxlbWVudCIsImZlZWRiYWNrIiwiYXBwZW5kVG8iLCJhZGRDbGFzcyIsInJlZ2lzdGVyRG9tRWxlbWVudHMiLCJyYWRpbyIsInNlbGVjdGVkIiwibWVkaWEiLCJsaWJyYXJ5Iiwic3BsaXQiLCJmaWxlIiwic2V0SW1hZ2UiLCJwYXRoIiwiZGlzYWJsZUltYWdlWm9vbWluZyIsImFsdCIsInRpdGxlIiwic291cmNlcyIsInNldFZpZGVvIiwiZmlsZXMiLCJzZXRBdWRpbyIsImNoZWNrYm94T3JSYWRpb0ljb24iLCJpbmRleE9mIiwic2V0SW50cm9kdWN0aW9uIiwibGFiZWwiLCJyZW5kZXIiLCJzZXRDb250ZW50IiwiJGFuc3dlcnMiLCJlYWNoIiwidW5kZWZpbmVkIiwidHJpbSIsInJlcGxhY2UiLCIkd3JhcCIsIiRNdWx0aUNob2ljZVNjb3JlNExNU1RpcCIsInRpcHNMYWJlbCIsImFwcGVuZCIsImNsaWNrIiwiJHRpcENvbnRhaW5lciIsInBhcmVudHMiLCJvcGVuRmVlZGJhY2siLCJjaGlsZHJlbiIsImlzIiwiYXR0ciIsInJlYWQiLCJ0cmlnZ2VyIiwic2V0VGltZW91dCIsImtleWRvd24iLCJlIiwid2hpY2giLCJ0b2dnbGVDaGVjayIsIiRhbnMiLCJhbnN3ZXJlZCIsIm51bSIsInBhcnNlSW50IiwiZGF0YSIsIm5vdCIsInBvcyIsInNwbGljZSIsInB1c2giLCJjYWxjU2NvcmUiLCJ0cmlnZ2VyWEFQSSIsImhpZGVTb2x1dGlvbiIsInNob3dCdXR0b24iLCJoaWRlQnV0dG9uIiwiY2hlY2tBbnN3ZXIiLCJzaG93Q2hlY2tTb2x1dGlvbiIsImdldE1heFNjb3JlIiwia2V5Q29kZSIsIiRwcmV2IiwicHJldiIsImZvY3VzIiwiJG5leHQiLCJuZXh0IiwiYmx1ciIsImZpbHRlciIsImZpcnN0IiwiYWRkIiwibGFzdCIsImFkZEJ1dHRvbnMiLCJoYXNDaGVja2VkQW5zd2VyIiwic2hvd0FsbFNvbHV0aW9ucyIsIiRlIiwiaHRtbCIsImRpc2FibGVJbnB1dCIsInNob3dTb2x1dGlvbnMiLCIkYW5zd2VyIiwiaGlkZVNvbHV0aW9ucyIsInJlbW92ZUZlZWRiYWNrIiwicmVzZXRUYXNrIiwicmVtb3ZlU2VsZWN0aW9ucyIsImVuYWJsZUlucHV0IiwiY2FsY3VsYXRlTWF4U2NvcmUiLCJtYXhTY29yZSIsImNob2ljZSIsInhBUElFdmVudCIsImNyZWF0ZVhBUElFdmVudFRlbXBsYXRlIiwiYWRkUXVlc3Rpb25Ub1hBUEkiLCJhZGRSZXNwb25zZVRvWEFQSSIsIiRjb250YWluZXIiLCIkY29udGVudCIsIiRjb250YWluZXJQYXJlbnRzIiwiZG9jdW1lbnQiLCJib2R5IiwiYWRkQnV0dG9uIiwidXBkYXRlRmVlZGJhY2tDb250ZW50IiwiY29uZmlybWF0aW9uRGlhbG9nIiwiZW5hYmxlIiwiY29uZmlybUNoZWNrRGlhbG9nIiwibDEwbiIsImNvbmZpcm1DaGVjayIsImluc3RhbmNlIiwiJHBhcmVudEVsZW1lbnQiLCJ0ZXh0SWZTdWJtaXR0aW5nIiwib2xkSWRNYXAiLCJpZE1hcCIsImdldFNodWZmbGVNYXAiLCJhbnN3ZXJzRGlzcGxheWVkIiwiZGV0YWNoIiwiY29uZmlybVJldHJ5RGlhbG9nIiwiY29uZmlybVJldHJ5IiwiaW5zZXJ0RmVlZGJhY2siLCJvbiIsInNraXBGZWVkYmFjayIsInNjb3JlUG9pbnRzIiwiU2NvcmVQb2ludHMiLCJhIiwiY2hvc2VuIiwiaGFzQ2xhc3MiLCJjb3JyZWN0QW5zd2VyIiwid3JvbmdBbnN3ZXIiLCJhbHRlcm5hdGl2ZUNvbnRhaW5lciIsInF1ZXJ5U2VsZWN0b3IiLCJhcHBlbmRDaGlsZCIsImdldEVsZW1lbnQiLCJtYXgiLCJzZXRGZWVkYmFjayIsInJhdGlvIiwiZGV0ZXJtaW5lT3ZlcmFsbEZlZWRiYWNrIiwiZ2V0RmVlZGJhY2tUZXh0IiwiZ2V0WEFQSURhdGEiLCJzdGF0ZW1lbnQiLCJkZWZpbml0aW9uIiwiZ2V0VmVyaWZpZWRTdGF0ZW1lbnRWYWx1ZSIsImRlc2NyaXB0aW9uIiwiaW50ZXJhY3Rpb25UeXBlIiwiY29ycmVjdFJlc3BvbnNlc1BhdHRlcm4iLCJjaG9pY2VzIiwib3JpZ2luYWxPcmRlciIsInN1Y2Nlc3MiLCJzZXRTY29yZWRSZXN1bHQiLCJyZXNwb25zZSIsInJlc3VsdCIsInNodWZmbGVBcnJheSIsInByZXZpb3VzU3RhdGUiLCJrIiwiaiIsImFucyIsInJvbGUiLCJ0YWJpbmRleCIsImNoZWNrZWQiLCJjb3VudGVyIiwiZ2V0Q3VycmVudFN0YXRlIiwic3RhdGUiLCJnZXRBbnN3ZXJHaXZlbiIsImlnbm9yZUNoZWNrIiwiZ2V0U2NvcmUiLCJnZXRUaXRsZSIsImNyZWF0ZVRpdGxlIiwibWV0YWRhdGEiLCJwcm90b3R5cGUiLCJPYmplY3QiLCJjcmVhdGUiLCJjb25zdHJ1Y3RvciJdLCJzb3VyY2VSb290IjoiIn0=